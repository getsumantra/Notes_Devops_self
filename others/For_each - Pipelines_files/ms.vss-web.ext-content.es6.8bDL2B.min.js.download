"use strict";define("VSS/Ext",["require","exports","VSS/Platform/Context","VSS/Platform/Fetch","VSS/Platform/Util/Cookie","VSS/Platform/Util/Url","VSS/Platform/Feature","react","VSS/Platform/Components/Format","VSS/Platform/Layout","VSS/Platform/Telemetry","VSS/Core/Observable","VSS/Platform/UserClaims"],(function(e,t,n,i,o,r,s,a,c,d,l,h,u){var g,m,p,x,b,v,f,C;g=t[C="Resources"]={},t[C].loading="Loading...",t[C].slowLoadWarning="{0} is taking longer than expected to load.",t[C].extensionError="{0} failed to load.",function(e){m=t[e]={};const a="GALLERY-CDN",c="GALLERY-FALLBACK";function d(e){const t=e.indexOf("."),n=e.substr(0,t);let i=e.substr(t+1);const o=i.indexOf(".");return-1!==o&&(i=i.substr(0,o)),{id:`${n}.${i}`,publisherId:n,extensionId:i}}function l(e,t){var i,o;const r=e.getService("IVssPageService").getData(),s=(0,n.getPageContext)("ms.vss-web.legacy-platform-data-provider"),a={host:{id:r.hostId,name:r.hostName,serviceVersion:r.serviceVersion,type:r.hostType,isHosted:null==s?void 0:s.webAccessConfiguration.isHosted},user:{descriptor:r.user.descriptor,id:r.user.id,name:r.user.uniqueName,displayName:r.user.displayName,imageUrl:r.user.imageUrl},pageContext:{globalization:null==s?void 0:s.globalization,timeZonesConfiguration:null==s?void 0:s.timeZonesConfiguration,webContext:{project:null===(i=null==s?void 0:s.webContext)||void 0===i?void 0:i.project,team:null===(o=null==s?void 0:s.webContext)||void 0===o?void 0:o.team}},extension:d(t)},c=e.getService("IVssContributionService").getContributionProvider(t);return c&&(a.extension.version=c.version),a}async function h(e,t){var i,o;const r=e.getService("IVssPageService").getData(),s=(0,n.getPageContext)("ms.vss-web.legacy-platform-data-provider");let a={host:{id:r.hostId,name:r.hostName,serviceVersion:r.serviceVersion,type:r.hostType,isHosted:null==s?void 0:s.webAccessConfiguration.isHosted},user:{descriptor:r.user.descriptor,id:r.user.id,name:r.user.uniqueName,displayName:r.user.displayName,imageUrl:r.user.imageUrl},pageContext:{globalization:null==s?void 0:s.globalization,timeZonesConfiguration:null==s?void 0:s.timeZonesConfiguration,webContext:{project:null===(i=null==s?void 0:s.webContext)||void 0===i?void 0:i.project,team:null===(o=null==s?void 0:s.webContext)||void 0===o?void 0:o.team}},extension:d(t)};const c=e.getService("IVssContributionService"),l=c.getContributionProvider(t);if(l&&(a.extension.version=l.version),!a.pageContext.webContext.team&&a.pageContext.webContext.project){const e="ms.vss-tfs-web.team-context-data-provider";try{const t=await c.getDataAsync(e);t&&(a=Object.assign(Object.assign({},a),{pageContext:Object.assign(Object.assign({},a.pageContext),{webContext:Object.assign(Object.assign({},a.pageContext.webContext),{team:t})})}))}catch(e){}}return a}t[e].getExtensionIdentifier=d,t[e].getExternalPageContext=l,t[e].getExternalPageContextAsync=h;const u="00000029-0000-8888-8000-000000000000";function g(){return"disabled"===(0,o.getCookie)(a)}function p(e,t){let n;const i=e.getService("IVssContributionService").getContributionProvider(t);return i&&(n=i.fallbackBaseUri&&g()?i.fallbackBaseUri:i.baseUri),n}function x(e,t,n,i){return n.indexOf("{{")<0?Promise.resolve(n):e.getService("IVssContributionService").getContributionAsync("ms.vss-web.mustache-content").then((()=>{if((0,s.isFeatureFlagEnabled)(e,"VisualStudio.Services.WebPlatform.ExposeTeamContextInNewWebPlatform",!1))return h(e,t).then((e=>{const t=Object.assign(Object.assign({account:{id:e.host.id,name:e.host.name}},e),i);try{n=window.LWL.req("mustache").render(n,t)}catch(e){}return n}));{const o=l(e,t),r=Object.assign(Object.assign({account:{id:o.host.id,name:o.host.name}},o),i);try{n=window.LWL.req("mustache").render(n,r)}catch(e){}return n}}))}t[e].isExtensionFallbackEnabled=g,t[e].useExtensionFallback=function(e){(0,o.setCookie)(a,"disabled","/",void 0,e)},t[e].isGalleryFallbackDisabled=function(){return"disabled"===(0,o.getCookie)(c)},t[e].disableGalleryFallback=function(e){(0,o.setCookie)(c,"disabled","/",void 0,e)},t[e].isMarketplaceAvailable=function(e){return e.getService("IVssLocationService").getServiceLocationAsync(u,1).then((e=>(0,i.issueRequest)(e+"_apis/health").then((e=>e.ok)).catch((()=>!1)))).catch((()=>!1))},t[e].getExtensionBaseUrl=p,t[e].getExtensionMarketplaceUrl=function(e,t){return e.getService("IVssLocationService").getServiceLocationAsync(u,1).then((n=>e.getService("IVssPageService").getData().isHosted?(0,r.combineUrlPaths)(n,"items?itemName="+t):(0,r.combineUrlPaths)(n,"_gallery/items?itemName="+t)))},t[e].getContributionContentProps=function(e,t,n,i){return new Promise(((o,s)=>{e.getService("IVssContributionService").getContributionAsync(t).then((s=>{s&&(i||s.uri)?x(e,t,i||s.uri,n).then((i=>{const a=!1!==s.interactive;if(!i.startsWith("http://")&&!i.startsWith("https://")){const s=p(e,t);if(s)return void x(e,t,s,n).then((e=>{i=(0,r.combineUrlPaths)(e,i),o({url:i,interactive:a})}))}o({url:i,interactive:a})})):o(void 0)}))}))}}("ExternalContentUtil"),function(e){p=t[e]={};class n extends a.Component{constructor(e,t){super(e,t),this.resolveIFrameRef=e=>{const{getInteractionProvider:t}=this.props;this.disposeInteractionProvider(),e&&t&&(this.interactionProvider=t(e),this.interactionProvider&&(this.interactionProvider.subscribe((e=>{var t;this.props.onLoaded&&this.props.onLoaded(e),(null===(t=this.context)||void 0===t?void 0:t.pageContext)&&this.state.loading&&(0,l.publishEvent)(this.context.pageContext,"Extensions","Extensions.Loaded",{contributionId:this.props.contributionId}),this.clearLoadingIndicator(),this.setState({loading:!1,showLoadingIndicator:!1,themeless:!e.themed})}),"loaded"),this.interactionProvider.subscribe((e=>{(0,m.isExtensionFallbackEnabled)()||(0,m.isGalleryFallbackDisabled)()||(0,m.isMarketplaceAvailable)(this.context.pageContext).then((e=>{e?((0,m.useExtensionFallback)(600),(0,l.publishEvent)(this.context.pageContext,"Extensions","Extensions.UseGalleryFallback",{contributionId:this.props.contributionId})):((0,m.disableGalleryFallback)(600),(0,l.publishEvent)(this.context.pageContext,"Extensions","Extensions.DisableGalleryFallback",{contributionId:this.props.contributionId}))})),this.clearLoadingIndicator(),this.setState({loadError:e,loading:!e.loadComplete,showLoadingIndicator:!e.loadComplete})}),"loadError")))},this.state={loading:!!e.getInteractionProvider,showLoadingIndicator:!1,currentUrl:e.url}}static getDerivedStateFromProps(e,t){return e.url!==t.currentUrl?{loading:!0,currentUrl:e.url}:null}render(){const{className:e,renderLoadingIndicator:t,renderLoadError:n,url:o}=this.props,{loading:r,showLoadingIndicator:s,loadError:c,themeless:l}=this.state;return a.createElement("div",{className:(0,d.css)("external-content flex-column relative",e)},c&&(n?n(c):a.createElement(i,{loadError:c})),s&&(t?t():a.createElement("div",{className:"flex flex-grow flex-center justify-center"},a.createElement(d.WrappedComponent,{wrappedType:"spinner",size:"large",label:g.loading}))),o&&a.createElement("iframe",{className:(0,d.css)("external-content--iframe flex-grow",r&&"invisible",l&&"themeless"),role:"presentation",frameBorder:0,ref:this.resolveIFrameRef,src:o}))}componentDidMount(){this.updateLoadingIndicator()}componentDidUpdate(e,t){this.updateLoadingIndicator()}componentWillUnmount(){this.disposeInteractionProvider()}updateLoadingIndicator(){!this.showLoadingIndicatorTimeout&&this.state.loading&&(this.showLoadingIndicatorTimeout=window.setTimeout((()=>{this.setState({showLoadingIndicator:!0})}),250))}clearLoadingIndicator(){window.clearTimeout(this.showLoadingIndicatorTimeout),this.showLoadingIndicatorTimeout=0}disposeInteractionProvider(){this.interactionProvider&&(this.interactionProvider.dispose(),this.interactionProvider=void 0)}}t[e].ExternalContentBase=n,n.contextType=d.VssComponentContext;class i extends d.VssComponent{constructor(e,t){super(e,t),this.state={}}componentDidMount(){super.componentDidMount(),(0,m.getExtensionMarketplaceUrl)(this.context.pageContext,this.props.loadError.extensionId).then((e=>{this.setState({extensionUrl:e})}))}render(){const{loadError:e}=this.props,{extensionUrl:t}=this.state;return a.createElement(c.FormatComponent,{className:(0,d.css)("external-content-message font-size-m",e.loadComplete?"error":"warning"),format:e.messageFormat,elementType:"span"},a.createElement("a",{href:t},e.extensionName))}}t[e].ExternalContentError=i}("ComponentsExternalContentExternalContentBase"),function(e){x=t[e]={};const i=parseInt("10000000000",36),o=Number.MAX_SAFE_INTEGER||9007199254740991,r="abcdefghijklmnopqrstuvwxyz0123456789".split("");class s{constructor(){this.objects={}}register(e,t){this.objects[e]=t}unregister(e){delete this.objects[e]}getInstance(e,t){const n=this.objects[e];if(n)return"function"==typeof n?n(t):n}}t[e].XDMObjectRegistry=s;let a=1;class c{constructor(e,t,n){this.promises={},this.nextMessageId=1,this.nextProxyId=1,this.proxyFunctions={},this.proxyFunctionIsLegacy={},this.postToWindow=e,this.targetOrigin=t,this.registry=new s,this.channelId=a++,this.pageContext=n,this.targetOrigin||(this.handshakeToken=function(){if(window.crypto&&window.Uint8Array&&Array.from){const e=new window.Uint8Array(22);return window.crypto.getRandomValues(e),Array.from(e).map((e=>r[e%r.length])).join("")}return Math.floor(Math.random()*(o-i)+i).toString(36)+Math.floor(Math.random()*(o-i)+i).toString(36)}())}getObjectRegistry(){return this.registry}invokeRemoteMethod(e,t,n,i,o){const r={id:this.nextMessageId++,methodName:e,instanceId:t,instanceContext:i,params:this._customSerializeObject(n,{serializeUnderscoreProperties:o&&o.includeUnderscoreProperties}),serializationSettings:o};this.targetOrigin||(r.handshakeToken=this.handshakeToken);const s=new Promise(((e,t)=>{this.promises[r.id]={resolve:e,reject:t}}));return this._sendRpcMessage(r),s}getRemoteObjectProxy(e,t){return this.invokeRemoteMethod("",e,void 0,t)}onMessage(e){if(e.instanceId){let t;if("__proxyFunctions"===e.instanceId&&e.methodName){const t=this.proxyFunctionIsLegacy[e.methodName];this.invokeMethod(this.proxyFunctions[e.methodName],{},e,{useLegacySerialization:t})}else{if(t=this.getRegisteredObject(e.instanceId,e.instanceContext),!t)return!1;"function"==typeof t.then?t.then((t=>{this.invokeMethodByName(t,e)}),(t=>{this.error(e,t)})):this.invokeMethodByName(t,e)}}else{const t=this.promises[e.id];if(!t)return!1;e.error?t.reject(this._customDeserializeObject([e.error],{})[0]):t.resolve(this._customDeserializeObject([e.result],{})[0]),delete this.promises[e.id]}return!0}owns(e,t,n){if(this.postToWindow===e){if(this.targetOrigin)return!!t&&("null"===t.toLowerCase()||0===this.targetOrigin.toLowerCase().indexOf(t.toLowerCase()));if(n.handshakeToken&&n.handshakeToken===this.handshakeToken)return this.targetOrigin=t,!0}return!1}error(e,t){this._sendRpcMessage({id:e.id,error:this._customSerializeObject([t],{serializeUnderscoreProperties:e.serializationSettings&&e.serializationSettings.includeUnderscoreProperties})[0],handshakeToken:e.handshakeToken})}invokeMethodByName(e,t){if(!t.methodName)return void this._success(t,e,t.handshakeToken,{});const i=e[t.methodName];return this.invokeMethod(i,e,t,e[n.RemoteSerializationSettingsKey])}invokeMethod(e,t,n,i){if("function"==typeof e)try{let o=[];n.params&&(o=this._customDeserializeObject(n.params,{}));const r=e.apply(t,o);r&&r.then&&"function"==typeof r.then?r.then((e=>{this._success(n,e,n.handshakeToken,i)}),(e=>{this.error(n,e)})):this._success(n,r,n.handshakeToken,i)}catch(e){this.error(n,e)}else this.error(n,new Error("RPC method not found: "+n.methodName))}getRegisteredObject(n,i){let o=this.registry.getInstance(n,i);return o||(o=t[e].globalObjectRegistry.getInstance(n,i)),o}_success(e,t,n,i={}){this._sendRpcMessage({id:e.id,result:this._customSerializeObject([t],Object.assign(Object.assign({},i),{serializeUnderscoreProperties:e.serializationSettings&&e.serializationSettings.includeUnderscoreProperties}),void 0,1,1)[0],handshakeToken:n})}_sendRpcMessage(e){this.postToWindow.postMessage(JSON.stringify(e),"*")}_customSerializeObject(e,t,i,o=1,r=1){if(!e||r>100)return null;if(e instanceof Node||e instanceof Window||e instanceof Event)return null;let s,a;a=i||{newObjects:[],originalObjects:[]},a.originalObjects.push(e);const c=(t,n,i,s)=>{let c;try{c=t[i]}catch(e){}const d=typeof c;if("undefined"===d)return;let l=-1;if("object"===d&&(l=a.originalObjects.indexOf(c)),l>=0){const e=a.newObjects[l];e.__circularReferenceId||(e.__circularReferenceId=o++),n[i]={__circularReference:e.__circularReferenceId}}else"function"===d?(s.useLegacySerialization||s.proxyFunctions)&&(n[i]={__proxyFunctionId:this._registerProxyFunction(c,e,s.useLegacySerialization),_channelId:this.channelId}):"object"===d?c&&c instanceof Date?n[i]={__proxyDate:c.getTime()}:n[i]=this._customSerializeObject(c,s,a,o,r+1):"__proxyFunctionId"!==i&&(n[i]=c)},d=this._getSerializationSettings(e,t);if(e instanceof Array){s=[],a.newObjects.push(s);for(let t=0,n=e.length;t<n;t++)c(e,s,t,this._getSerializationSettings(e[t],d))}else{s={},a.newObjects.push(s);let t={};try{t=function(e){const t={};for(;e&&e!==Object.prototype;){const n=Object.getOwnPropertyNames(e);for(const e of n)"constructor"!==e&&(t[e]=!0);e=Object.getPrototypeOf(e)}return t}(e)}catch(e){}for(const i in t)i===n.RemoteSerializationSettingsKey||!d.serializeUnderscoreProperties&&i&&"_"===i[0]||d.ignoredProperties&&d.ignoredProperties[i]||c(e,s,i,d)}return a.originalObjects.pop(),a.newObjects.pop(),s}_getSerializationSettings(e,t){if(e){const i=e[n.RemoteSerializationSettingsKey];if(i)return t.useLegacySerialization&&(i.useLegacySerialization=!0),i}return t}_registerProxyFunction(e,t,n){const i=this.nextProxyId++,o="proxy"+i;return this.proxyFunctions[o]=function(){return e.apply(t,Array.prototype.slice.call(arguments,0))},this.proxyFunctionIsLegacy[o]=n,i}_customDeserializeObject(e,t){const n=this;if(!e)return null;const i=(e,i)=>{const o=e[i],r=typeof o;"__circularReferenceId"===i&&"number"===r?(t[o]=e,delete e[i]):"object"===r&&o&&(o.__proxyFunctionId?e[i]=function(){return n.invokeRemoteMethod("proxy"+o.__proxyFunctionId,"__proxyFunctions",Array.prototype.slice.call(arguments,0),{},{includeUnderscoreProperties:!0})}:o.__proxyDate?e[i]=new Date(o.__proxyDate):o.__circularReference?e[i]=t[o.__circularReference]:this._customDeserializeObject(o,t))};if(e instanceof Array)for(let t=0,n=e.length;t<n;t++)i(e,t);else if("object"==typeof e)for(const t in e)i(e,t);return e}}t[e].XDMChannel=c;t[e].globalObjectRegistry=new s,t[e].channelManager=new class{constructor(){this._channels=[],this._handleMessageReceived=e=>{let t;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){}if(t){let n,i=!1;for(const o of this._channels)o.owns(e.source,e.origin,t)&&(n=o,i=o.onMessage(t)||i);n&&!i&&(window.console&&console.error(`No handler found on any channel for message: ${JSON.stringify(t)}`),t.instanceId&&n.error(t,new Error(`The registered object ${t.instanceId} could not be found.`)))}},window.addEventListener("message",this._handleMessageReceived)}addChannel(e,t,n){const i=new c(e,t,n);return this._channels.push(i),i}removeChannel(e){this._channels=this._channels.filter((t=>t!==e))}}}("Xdm"),function(e){b=t[e]={};class i extends h.Observable{constructor(e,t,n,i,o=0,r=!1){super(),this.pageContext=e,this.iframe=t,this.contributionId=n,this.initialHandshakeData=i,this.resizeOptions=o,this.backgroundHost=r,this.notifyLoaded=()=>{window.clearTimeout(this.slowLoadTimeout),this.notify({proxy:this.xdmChannel,themed:this.themed,sdkVersion:this.sdkVersion},"loaded")},this.notifyLoadFailed=e=>{window.clearTimeout(this.slowLoadTimeout),this.notify({messageFormat:g.extensionError+" "+(e&&e.message?e.message:e),extensionName:this.contributionProvider.displayName,extensionId:this.contributionProvider.id,loadComplete:!0,error:e},"loadError")},this.onThemeChanged=e=>{this.xdmChannel&&this.xdmChannel.invokeRemoteMethod("dispatchEvent","DevOps.SdkClient",["themeChanged",{detail:e}])},this.xdmChannel=x.channelManager.addChannel(t.contentWindow,t.src,this.pageContext);const s=this.getHostControl();this.xdmChannel.getObjectRegistry().register("DevOps.HostControl",s),this.xdmChannel.getObjectRegistry().register("VSS.HostControl",s);const a=this.pageContext.getService("IVssContributionService");this.contributionProvider=a.getContributionProvider(this.contributionId),this.slowLoadTimeout=window.setTimeout((()=>{this.notify({messageFormat:g.slowLoadWarning,extensionName:this.contributionProvider.displayName,extensionId:this.contributionProvider.id,loadComplete:!1},"loadError")}),1e4)}dispose(){if(this.xdmChannel&&(x.channelManager.removeChannel(this.xdmChannel),this.xdmChannel=void 0),window.clearTimeout(this.slowLoadTimeout),this.themed){this.pageContext.getService("IVssThemeService").unsubscribe(this.onThemeChanged,"themeChanged")}this.disposed=!0}delayedNotifyLoaded(){window.setTimeout((()=>{this.disposed||this.notifyLoaded()}),0)}getLegacyHostManagementService(){if(!this.legacyHostManagementPromise){const e=this.pageContext.getService("IVssContributionService");this.legacyHostManagementPromise=e.getContributionsAsync(["ms.vss-web.legacy-platform-component"]).then((()=>this.pageContext.getService("ILegacyPlatformService").requireModules(["VSS/SDK/Host"]).then((([e])=>{const t=(0,m.getExtensionBaseUrl)(this.pageContext,this.contributionId),i=(0,m.getExtensionIdentifier)(this.contributionProvider.id),o=i.publisherId,r=i.extensionId,s=new e.HostManagementService({publisherId:o,extensionId:r,baseUri:t,contributionId:this.contributionId,version:this.contributionProvider.version,initialConfig:this.initialHandshakeData});return s[n.RemoteSerializationSettingsKey]={useLegacySerialization:!0},s}))))}return this.legacyHostManagementPromise}getHostControl(){return{[n.RemoteSerializationSettingsKey]:{proxyFunctions:!0},resize:(e,t)=>{2&this.resizeOptions||void 0===t||(this.iframe.style.height=t+"px"),4&this.resizeOptions||void 0===e||(this.iframe.style.width=e+"px"),this.notify({height:t,width:e},"resized")},initialHandshake:e=>{if(e){this.sdkVersion=e.sdkVersion||0;const t=this.sdkVersion>0;let i;if(this.themed=t&&!this.backgroundHost?!1!==e.applyTheme:!0===e.applyTheme,this.themed){const e=this.pageContext.getService("IVssThemeService");i=e.getCurrentTheme().data,e.subscribe(this.onThemeChanged,"themeChanged")}if(t){return!1!==e.loaded&&this.delayedNotifyLoaded(),this.xdmChannel.getObjectRegistry().register("DevOps.ServiceManager",{[n.RemoteSerializationSettingsKey]:{proxyFunctions:!0},getService:e=>{const t=this.pageContext.getService("IVssContributionService");return t.getContributionAsync(e).then((i=>{if(i){if(i.serviceName)return t.getServiceEx(e,i,!0);{const t=i;if(t.content&&t.content.require)return this.getLegacyHostManagementService().then((t=>t.getServiceContribution(e).then((e=>e.getInstance().then((e=>(e&&(e[n.RemoteSerializationSettingsKey]={useLegacySerialization:!0}),e)))))))}}return Promise.reject(void 0)}))}}),(0,s.isFeatureFlagEnabled)(this.pageContext,"VisualStudio.Services.WebPlatform.ExposeTeamContextInNewWebPlatform",!1)?(0,m.getExternalPageContextAsync)(this.pageContext,this.contributionId).then((e=>({contributionId:this.contributionId,initialConfig:this.initialHandshakeData,context:e,themeData:i}))).catch((()=>(this.notifyLoadFailed("Failed to populate the extension context."),Promise.reject()))):{contributionId:this.contributionId,initialConfig:this.initialHandshakeData,context:(0,m.getExternalPageContext)(this.pageContext,this.contributionId),themeData:i}}{const t=e;return this.getLegacyHostManagementService().then((e=>{const o=this.pageContext.getService("IVssContributionService");return this.pageContext.getService("ILegacyPlatformService").getLegacyPageContext(!0).then((r=>{t.notifyLoadSucceeded&&this.delayedNotifyLoaded(),this.xdmChannel.getObjectRegistry().register("vss.hostManagement",e);const s=(0,m.getExtensionBaseUrl)(this.pageContext,this.contributionId),a=(0,m.getExtensionIdentifier)(this.contributionProvider.id),c=a.publisherId,d=a.extensionId;let l=this.initialHandshakeData;return"object"==typeof l&&(l=Object.assign({},l),l[n.RemoteSerializationSettingsKey]={useLegacySerialization:!0}),{pageContext:r,initialConfig:l,extensionContext:{publisherId:c,extensionId:d,baseUri:s,version:this.contributionProvider.version},contribution:{id:this.contributionId,properties:o.getContribution(this.contributionId)},themeData:i}}))}))}}},notifyLoadSucceeded:this.notifyLoaded,notifyLoadFailed:this.notifyLoadFailed,getAccessToken:()=>{if((0,u.userHasClaim)(this.pageContext,"member")){return this.pageContext.getService("IAuthenticationService").getExtensionTokenProvider(this.contributionProvider.id,0).getSessionToken()}return Promise.resolve({})},getAppToken:()=>{if((0,u.userHasClaim)(this.pageContext,"member")){return this.pageContext.getService("IAuthenticationService").getExtensionTokenProvider(this.contributionProvider.id,1).getSessionToken()}return Promise.resolve({})}}}}t[e].SdkInteractionProvider=i}("ComponentsExternalContentSdkInteractionProvider"),function(e){v=t[e]={};class n extends d.VssComponent{constructor(e,t){super(e,t),this.state={}}render(){const{backgroundHost:e,contributionId:t,initialHandshakeData:n,resizeOptions:i}=this.props,{url:o,interactive:r}=this.state;let s;return o&&r&&(s=o=>new b.SdkInteractionProvider(this.context.pageContext,o,t,n,i,e)),o?a.createElement(p.ExternalContentBase,Object.assign({},this.props,{url:o,getInteractionProvider:s})):a.createElement("div",null)}componentDidMount(){super.componentDidMount(),this.updateContentProperties()}componentDidUpdate(e,t){super.componentDidUpdate(e,t),this.props.contributionId!==e.contributionId&&this.updateContentProperties()}updateContentProperties(){this.trackPromise((0,m.getContributionContentProps)(this.context.pageContext,this.props.contributionId,this.props.initialHandshakeData,this.props.contributionUri)).promise.then((e=>{this.setState({url:e?e.url:void 0,interactive:e&&e.interactive})}))}}t[e].ExternalContent=n,d.Components.add("ExternalContent",n)}("ComponentsExternalContentExternalContent"),function(e){f=t[e]={},__exportStar(v,t[e]),__exportStar(p,t[e]),__exportStar(b,t[e])}("ExternalContent"),function(){t.ComponentsExternalNavigationExternalNavigation={};class e extends d.VssComponent{constructor(){super(...arguments),this._ttiMarked=!1,this.onLoaded=()=>{if(!this._ttiMarked){this.context.pageContext.getService("IVssPerformanceService").markTimeToInteractive("Extentions","Extension.Navigation."+this._contributionId)}}}render(){let e,t;const n=this.context.pageContext.getService("IVssNavigationService"),i=n.getDisplayedNavigation();if(i&&i.length){const o=n.getNavigation(i[i.length-1]);if(o&&(this._contributionId=o.id,e=o.id,window.location.search)){const e=this.context.pageContext.getService("IVssContributionService").getContribution(o.id);if(e&&e.uri){const n=new r.Uri(e.uri),i=new r.Uri(window.location.href);for(const e of i.queryParameters)n.addQueryParam(e.name,e.value);t=n.absoluteUri}}}return this._contributionId?a.createElement(f.ExternalContent,{className:"navigation-content flex-grow",contributionId:this._contributionId,contributionUri:t,key:e,onLoaded:this.onLoaded}):null}}d.Components.add("vss-ext.ExternalNavigation",e)}(),function(){t.RemoteServiceProvider={};class e extends n.VssService{constructor(){super(...arguments),this.backgroundHosts={}}getService(e,t){return this.getBackgroundHost(e,t).then((n=>n.proxy.getRemoteObjectProxy(t.serviceName||e,t.configuration).then((e=>(n.sdkVersion>0&&(e._sdkVersion=n.sdkVersion),e)))))}getBackgroundHost(e,t){const n=this.pageContext.getService("IVssContributionService").getContributionProvider(e);if(!n||!t.uri)return Promise.reject(new Error(`No contribution provider or uri for ${e}.`));const i=`${n.id}-${t.uri}`;let o=this.backgroundHosts[i];return o||(o=new Promise(((n,i)=>{this.pageContext.getService("IVssLayoutManager").renderCallout((o=>a.createElement(f.ExternalContent,{contributionId:e,contributionUri:t.uri,initialHandshakeData:t.configuration,className:"hidden",backgroundHost:!0,onLoaded:t=>{t.proxy?n(t):i(new Error(`No interaction proxy returned for ${e}.`))}})))})),this.backgroundHosts[i]=o,o)}}n.Services.add("ExternalContentServiceProvider",{serviceFactory:e})}()}),["Resources","ExternalContentUtil","Components/ExternalContent/ExternalContentBase","Xdm","Components/ExternalContent/SdkInteractionProvider","Components/ExternalContent/ExternalContent","ExternalContent","Components/ExternalNavigation/ExternalNavigation","RemoteServiceProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-web.ext-content"}}));