"use strict";define("Repos/Common",["require","exports","VSS/Core/Util/String","Tfs/Platform/Page","VSS/Platform/Context","VSS/Platform/Fetch","VSS/Platform/UserClaims","VSS/Platform/Util/Url","VSS/Platform/Trace","VSS/Platform/Location","VSS/Platform/FPS","VSS/Platform/Util/Linking","VSSUI/Utilities/Date"],(function(e,t,r,s,i,n,o,a,c,u,l,g,m){var p,h,d,v,f,y,S;p=t[S="Resources"]={},t[S].BranchNameErrorEmpty="The branch name cannot be empty.",t[S].BranchNameErrorInvalidCharacters="A branch name cannot contain '{0}'.",t[S].BranchNameErrorInvalidEndCharacters="A branch name cannot end with '{0}'.",t[S].BranchNameErrorInvalidStartCharacters="A branch name cannot start with '{0}'.",t[S].BranchNameErrorTooLong="The branch name is too long.",t[S].BranchNameErrorZeroWidthSpace="zero-width space symbol",t[S].BranchVersionDisplayText="Branch {0}",t[S].ChangeTypeAdd="add",t[S].ChangeTypeBranch="branch",t[S].ChangeTypeDelete="delete",t[S].ChangeTypeEdit="edit",t[S].ChangeTypeFileType="encoding",t[S].ChangeTypeLock="lock",t[S].ChangeTypeMerge="merge",t[S].ChangeTypeNone="none",t[S].ChangeTypeProperty="property",t[S].ChangeTypeRename="rename",t[S].ChangeTypeRollback="rollback",t[S].ChangeTypeSourceRename="source rename",t[S].ChangeTypeUndelete="undelete",t[S].CommitVersionDisplayText="Commit {0}",t[S].FileInvalidCharactersFormat="'{0}' is not a valid name. The name cannot contain any of the following characters: \" / : < > \\ * ?",t[S].FileInvalidEndCharactersFormat="'{0}' is not a valid name. The name cannot end with a dot (.) or a space.",t[S].FileSummaryTotalFile="{0} file change",t[S].FileSummaryTotalFiles="{0} file changes",t[S].FileSummaryAddedFile="{0} add",t[S].FileSummaryAddedFiles="{0} adds",t[S].FileSummaryEditedFile="{0} edit",t[S].FileSummaryEditedFiles="{0} edits",t[S].FileSummaryRenamedFile="{0} rename",t[S].FileSummaryRenamedFiles="{0} renames",t[S].FileSummaryDeletedFile="{0} delete",t[S].FileSummaryDeletedFiles="{0} deletes",t[S].TagVersionDisplayText="Tag {0}",t[S].TagNameErrorEmpty="Tag name cannot be empty.",t[S].TagNameErrorTooLong="Tag name too long.",t[S].TagNameErrorExists="The specified tag name already exists.",t[S].TagNameErrorInvalidTrailCharacter="A tag name cannot end with '{0}'.",t[S].TagNameErrorInvalidLeadCharacter="A tag name cannot start with '{0}'.",t[S].TagNameErrorInvalidCharacter="A tag name cannot contain '{0}'.",function(e){h=t[e]={},t[e].maxTagSuggestions=100,t[e].themeIndependentStyle={backgroundColor:"inherit",color:"inherit"};class r{}t[e].CustomerIntelligence=r,r.Area="Repos",r.PullRequestsList_ChangeFilter="PullRequestsList.ChangeFilter",r.FilesHub_NavigateToSubmodule="FilesHub.NavigateToSubmodule",r.FilesHub_NavigateToSubmoduleFailedMissingWebUrl="FilesHub.NavigateToSubmoduleFailedMissingWebUrl",r.FilesHub_DisabledGenerateGitCredentialsButtonTooltipShown="FilesHub.DisabledGenerateGitCredentialsButtonTooltipShown",r.FilesHub_ResolvedMarkdownPathChangedAfterFix="FilesHub.ResolvedMarkdownPathChangedAfterFix",r.PullRequests_CreateWorkItemFromPullRequest="PullRequests.CreateWorkItemFromPullRequest",r.PullRequests_SuggestionApplied="PullRequests.SuggestionApplied",r.PullRequests_SuggestionReverted="PullRequests.SuggestionReverted",r.PullRequests_ChangesCommitted="PullRequests.ChangesCommitted",r.PullRequestCreate_TooManyFilesWarningShown="PullRequestCreate.TooManyFilesWarningShown",r.PullRequestCreate_TooManyFilesWarningCancelled="PullRequestCreate.TooManyFilesWarningCancelled",r.PullRequestCreate_TooManyFilesWarningContinued="PullRequestCreate.TooManyFilesWarningContinued"}("Constants"),function(e){d=t[e]={},t[e].getVersionDisplayName=function(e){let t;switch(e.versionType){case 2:t=(0,r.format)(p.CommitVersionDisplayText,e.version);break;case 1:t=(0,r.format)(p.TagVersionDisplayText,e.version);break;default:t=(0,r.format)(p.BranchVersionDisplayText,e.version)}return t},t[e].getVersionString=function(e){let t;const r=1===e.versionOptions?"P":"";switch(e.versionType){case 2:t=r+"GC"+e.version;break;case 1:t=r+"GT"+e.version;break;default:t=r+"GB"+e.version}return t},t[e].branchToVersionDescriptor=function(e){return{version:e,versionType:0,versionOptions:0}},t[e].commitToVersionDescriptor=function(e){return{version:e,versionType:2,versionOptions:0}},t[e].getPreviousVersion=function(e){return Object.assign(Object.assign({},e),{versionOptions:1})},t[e].tagToVersionDescriptor=function(e){return{version:e,versionType:1,versionOptions:0}},t[e].gitVersionStringToVersionDescriptor=function(e){const t={versionOptions:0};let r=e||"";if("P"===r[0]&&(t.versionOptions=1,r=r.substr(1)),!(r.length>=2&&"G"===r[0].toUpperCase()))throw new Error("Unrecognized VersionSpec format.");{const e=r[1].toUpperCase();r=r.substr(2),"B"===e?(t.versionType=0,t.version=r):"C"===e?(t.versionType=2,t.version=r):"T"===e&&(t.versionType=1,t.version=r)}return t},t[e].isLatest=function(e){return!e||5===e.versionType},t[e].tfvcVersionStringToVersionDescriptor=function(e){const t={versionOption:0};let r=e||"";return"P"===r[0]&&(t.versionOption=1,r=r.substr(1)),r&&"T"!==r?r.startsWith("T")?(t.version=r.substr(1),t.versionType=6):r.startsWith("C")?(t.version=r.substr(1),t.versionType=1):r.startsWith("S")?(t.version=r.substr(1),t.versionType=2):(t.version=r,t.versionType=1):(t.version="",t.versionType=5),t},t[e].getTfvcVersionString=function(e){const t=1===e.versionOption?"P":"";switch(e.versionType){case 5:return t+"T";case 6:return t+"T"+e.version;case 1:return t+"C"+e.version;case 2:return t+"S"+e.version;default:return t+e.version}}}("UtilVersion"),function(e){v=t[e]={},t[e].EMPTY_OBJECT_ID="0000000000000000000000000000000000000000";const s=["~","^",":"," ","?","*","[","\\","/.",".lock/","//","..","@{"],i=["/","."],n=[".lock",".","/"],o="refs/",a=`${o}heads/`,c=`${o}tags/`,u=/[\u200B-\u200D\uFEFF]/g;function l(e){return(e||"").startsWith(a)?e.substr(a.length):e}function g(e){return(e||"").startsWith(c)?e.substr(c.length):e}function m(e){return 0===e.versionType?a+e.version:1===e.versionType?c+e.version:""}function h(e){return 0===(e||"").indexOf(a)}function f(e){return 0===(e||"").indexOf(c)}t[e].getInvalidBranchNameMessage=function(e){if(!e)return p.BranchNameErrorEmpty;if(e.length+a.length>400)return p.BranchNameErrorTooLong;for(const t of s)if(e.indexOf(t)>=0)return(0,r.format)(p.BranchNameErrorInvalidCharacters,t);for(const t of i)if(e.startsWith(t))return(0,r.format)(p.BranchNameErrorInvalidStartCharacters,t);for(const t of n)if(e.endsWith(t))return(0,r.format)(p.BranchNameErrorInvalidEndCharacters,t);return e.match(u)?(0,r.format)(p.BranchNameErrorInvalidCharacters,p.BranchNameErrorZeroWidthSpace):void 0},t[e].getInvalidTagNameMessage=function(e){if(!e)return p.TagNameErrorEmpty;if(e.length+c.length>400)return p.TagNameErrorTooLong;for(const t of s)if(e.indexOf(t)>=0)return(0,r.format)(p.TagNameErrorInvalidCharacter,t);for(const t of i)if(e.startsWith(t))return(0,r.format)(p.TagNameErrorInvalidLeadCharacter,t);for(const t of n)if(e.endsWith(t))return(0,r.format)(p.TagNameErrorInvalidTrailCharacter,t)},t[e].getShortCommitId=function(e){return e.substring(0,8)},t[e].isEmptyObjectId=function(r){return!r||r===t[e].EMPTY_OBJECT_ID},t[e].refToBranchName=l,t[e].refToBranchOrTagName=function(e){return h(e)?l(e):g(e)},t[e].refToTagName=g,t[e].branchNameToRef=function(e){return e.startsWith(a)||"~default"===e?`${e}`:`${a}${e}`},t[e].tagNameToRef=function(e){return e.startsWith(c)?`${e}`:`${c}${e}`},t[e].specToRefName=m,t[e].versionStringToRefName=function(e){return e?m((0,d.gitVersionStringToVersionDescriptor)(e)):e},t[e].getFriendlyName=function(e){return h(e)?e.substr(a.length):f(e)?e.substr(c.length):e},t[e].isBranch=h,t[e].isTag=f,t[e].getRefNameFromBranchName=function(e){return a+e},t[e].getRefNameFromTagName=function(e){return c+e},t[e].trimRefs=function(e){return(e||"").startsWith(o)?e.substr(5):e}}("UtilRef"),function(e){f=t[e]={};const r="ms.vss-code-web.versioncontrol-viewmodel-data-provider";class c extends i.VssService{getDefaultGitBranchName(){const e=this.getViewModel();let t=e.defaultGitBranchName;return!t&&e.gitRepository&&e.gitRepository.defaultBranch&&(t=(0,v.refToBranchName)(e.gitRepository.defaultBranch)),t}getRepository(){return this.getViewModel().gitRepository}getUserPreferences(){return this.userPreferences||(this.userPreferences=this.getViewModel().vcUserPreferences),this.userPreferences}getViewModel(){const e=this.pageContext.getService("IVssContributionService").getData(r);if(!e)throw new Error(`Data provider data "${r}" not present.`);return e}setUserDefaultBranch(e){this.pageContext.getService("ISettingsService").setEntries({"Git/DefaultUserBranch":e},0,"Repository",this.getRepository().id)}setUserPreferences(e){if(!(0,o.userHasClaim)(this.pageContext,"member"))return Promise.resolve(new Response);this.userPreferences=e;const t=this.pageContext.getService("IVssPageService").getData().hostPath||"",r=(0,s.getTFSProject)(this.pageContext),i=(0,a.combineUrlPaths)(encodeURI(t),(r?r.id+"/":"")+"_api/_versioncontrol/updateUserPreferences?__v=5");return(0,n.issueRequest)(i,{method:"POST",body:JSON.stringify({preferences:JSON.stringify(e)}),headers:{"Content-Type":"application/json"}})}supportsGit(){return this.getViewModel().projectVersionControlInfo.supportsGit}supportsTFVC(){return this.getViewModel().projectVersionControlInfo.supportsTFVC}}i.Services.add("IVCViewModelDataProviderService",{serviceFactory:c}),t[e].getGitRepository=function(e){return e.getService("IVCViewModelDataProviderService").getRepository()},t[e].setUserDefaultVersion=function(e,t){0===t.versionType&&e.getService("IVCViewModelDataProviderService").setUserDefaultBranch(t.version)}}("VCViewModelDataProviderService"),function(){t.Permissions={};const e="2e9eb7ed-3c0a-47d4-87c1-0ffdd275fd87",r="TFS.VersionControl.PermissionsDataProvider.SecurityToken.",n="ImplicitManageAdvSec",o="ms.vss-code-web.permissions-data-provider";class a extends i.VssService{_serviceStart(e){super._serviceStart(e);const t=e.getService("IVssContributionService");this.permissionData=t.getData(o)||{};const r=(0,s.getTFSPageData)(this.pageContext).project;r&&(this.defaultProjectId=r.id);try{const e=(0,f.getGitRepository)(this.pageContext);e&&(this.defaultRepositoryId=e.id)}catch(e){console.error(e),(0,c.traceException)(this.pageContext,"Repos","ReposPermissionsService._serviceStart",e)}this.asyncCache={}}hasPermission(e,t,r,s){return this.hasPermissionHelper(e,t,r,s)}hasFavoritesPermission(e){return this.hasFrameworkPermission("favorites",e)}hasSettingsPermission(e){return this.hasFrameworkPermission("settings/global",e)}hasPermissionAsync(e,t,r,s){const i=this.pageContext.getService("IVssContributionService"),n=r||(void 0===r?this.defaultRepositoryId||"undefined":"empty");let a=this.asyncCache[n];return a||(a=i.getDataAsync(o,{repositoryId:r}).then((e=>{this.permissionData=Object.assign(Object.assign({},this.permissionData),e)})),this.asyncCache[n]=a),a.then((()=>this.hasPermissionHelper(e,t,r,s)))}hasFrameworkPermission(e,t){const s=`${r}${e}`;let i=this.permissionData[s];if(i){const e=i.indexOf("/");if(e>=0){const r=i.substr(0,e);i=i.substr(e+1);return this.pageContext.getService("IVssSecurityService").hasPermission(r,i,t)}}return!1}hasPermissionHelper(t,s,i,o,a){let c;void 0===o&&(o=this.defaultProjectId),void 0===i&&(i=this.defaultRepositoryId),s&&0===s.versionType&&(c=(a||this.permissionData)[`${r}${o}/${i}/refs/heads/${s.version}`],c&&0===c.indexOf(e+"/")&&(c=c.substr(37))),c||(c="repoV2/",o&&(c+=o+"/",i&&(c+=i+"/")));let u=this.pageContext.getService("IVssSecurityService").hasPermission(e,c,t);return!i||16!==t||s||u||(u=!!this.permissionData[`${r}${o}/${i}/AnyCreateBranch`]),262144!=t||u||(u=i?!!this.permissionData[`${r}${o}/${i}/${n}`]:o?!!this.permissionData[`${r}${o}/${n}`]:!!this.permissionData[`${r}${n}`]),u}}i.Services.add("IReposPermissionsService",{serviceFactory:a})}(),function(){t.ProjectRepositoryInformationService={};class e extends i.VssService{getData(){return this.pageContext.getService("IVssContributionService").getData("ms.vss-code-web.navigation-data-provider")}getDataAsync(e){return this.pageContext.getService("IVssContributionService").getDataAsync("ms.vss-code-web.navigation-data-provider",void 0,e)}}i.Services.add("IProjectRepositoryInformationService",{serviceFactory:e})}(),function(e){y=t[e]={};const r={"ms.vss-code-web.git-repository-overview":"ms.vss-code-web.repository-overview-git-route","ms.vss-code-web.files-hub":"ms.vss-code-web.files-route-git","ms.vss-code-web.branches-hub":"ms.vss-code-web.branches-route","ms.vss-code-web.tags-hub":"ms.vss-code-web.tags-route","ms.vss-code-web.pushes-hub":"ms.vss-code-web.pushes-route","ms.vss-code-web.commits-hub":"ms.vss-code-web.commits-route","ms.vss-code-web.new-prs-hub":"ms.vss-code-web.lwp-prs-route","ms.vss-advsec.alerts-hub":"ms.vss-advsec.alerts-hub-route"};class s extends i.VssService{_serviceStart(e){super._serviceStart(e);try{const e=this.pageContext.getService("IVCViewModelDataProviderService").getRepository();this.repositoryId=e?e.id:""}catch(e){console.error(e),(0,c.traceException)(this.pageContext,"Repos","ReposRoutingService",e),this.repositoryId=""}}getBranchCompareUrl(e,t,r,s,i){const n={};return n.project=t,n["vc.GitRepositoryName"]=e,n.baseVersion=(0,d.getVersionString)(r),n.targetVersion=(0,d.getVersionString)(s),n._a=i||"commits",(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.branch-compare-route",n)}getBranchesUrl(e,t){const r={};return r.project=t,r["vc.GitRepositoryName"]=e,(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.branches-route",r)}getBranchPolicyUrl(e,t,r,s){s=s||this.repositoryId;let i="";const n={};return n.project=t,n.adminPivot="repositories",n._a="policiesMid",n.repo=s,n.refs=r,i=(0,u.routeUrl)(this.pageContext,"ms.vss-admin-web.project-admin-hub-route",n),i}getBranchSecurityUrl(e,t,r){const s=(0,v.getRefNameFromBranchName)(r),i={};return i.project=t,i.adminPivot="repositories",i._a="permissionsMid",i.repo=e,i.refs=s,(0,u.routeUrl)(this.pageContext,"ms.vss-admin-web.project-admin-hub-route",i)}getCommitUrl(e,t,r,s,i,n){const o={};return o.project=t,o["vc.GitRepositoryName"]=e,o.parameters=r,s&&(o.refName=s),i&&(o.path=i,o._a=n||"contents"),(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.commit-route",o)}getCommitsUrl(e,t,r){const s={};return s.project=t,s["vc.GitRepositoryName"]=e,r&&(s.itemVersion=(0,d.getVersionString)(r)),(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.commits-route",s)}getFilesBlameUrl(e,t,r,s){return this.getFilesUrlForTab(e,t,r,s,"blame")}getFilesCompareUrl(e,t,r,s,i,n){const o={};return o.project=t,o["vc.GitRepositoryName"]=e,o._a="compare",o.oversion=(0,d.getVersionString)(i),o.mversion=(0,d.getVersionString)(n),o.version=(0,d.getVersionString)(s),o.path=r,(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.files-route",o)}getFilesHistoryUrl(e,t,r,s){return this.getFilesUrlForTab(e,t,r,s,"history")}getFilesUrl(e,t,r,s,i){return this.getFilesUrlForTab(e,t,r,s,void 0,i)}getPullRequestCreateUrl(e,t,r,s,i,n,o,a,c,l){const g=this.pageContext.getService("IVssNavigationService").getRouteValues(),m={};m.project=t||g.project;const p=e||g.GitRepositoryName;return p&&(m["vc.GitRepositoryName"]=p),r&&(m.sourceRef=r),s&&null!==s&&(m.targetRef=s),i&&(m.sourceRepositoryId=i),n&&(m.targetRepositoryId=n),o&&(m.cherryPickId=o.toString()),a&&(m.revertId=a.toString()),c&&(m.cherryPickCommit=c),l&&(m.revertCommit=l),(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.pull-request-create-route",m)}getPullRequestUrl(e,t,r,s,i,n,o,a){const c={};return c.project=t,c["vc.GitRepositoryName"]=e,c.parameters=r.toString(),s&&(c._a=s),i&&(c.path=i),n&&(c.iteration=n),o&&(c.base=o),a&&(c.discussionId=a.toString()),(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.pull-request-review-route",c)}getPullRequestsUrl(e,t,r,s){const i=this.pageContext.getService("IVssNavigationService").getRouteValues(),n={};return n.project=i.project,e&&(n._a=e),i.GitRepositoryName&&(n["vc.GitRepositoryName"]=i.GitRepositoryName),t&&(n.createdBy=t),r&&(n.assignedTo=r),s&&(n.targetRefName=s),(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.lwp-prs-route",n)}getPushUrl(e,t,r){const s={};return s.project=t,s["vc.GitRepositoryName"]=e,s.parameters=r.toString(),(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.push-details-route",s)}getPushesUrl(e,t,r){const s=Object.assign({},r);return s.project=t,s["vc.GitRepositoryName"]=e,(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.pushes-route",s)}getSwitchRepositoryURL(e,t,s){const i={};let n;if(e){const e=this.pageContext.getService("IVssNavigationService").getDisplayedNavigation()[3];n=r[e]||"ms.vss-code-web.files-route-git"}else n="ms.vss-code-web.tfvc-files-route";return t&&(i.project=t),e&&(i["vc.GitRepositoryName"]=e),s&&(i.version=(0,d.getVersionString)(s)),(0,u.routeUrl)(this.pageContext,n,i)}getFilesUrlForTab(e,t,r,s,i,n){const o={};return o.project=t,o["vc.GitRepositoryName"]=e,i&&(o._a=i),r&&(o.path=r),s&&(o.version=(0,d.getVersionString)(s)),n&&(o.anchor=n),(0,u.routeUrl)(this.pageContext,"ms.vss-code-web.files-route-git",o)}}const n="IReposRoutingService";t[e].getReposRoutingService=function(e){return e.getService(n)},i.Services.add(n,{serviceFactory:s})}("ReposRoutingService"),function(e){t[e]={};class r extends i.VssService{createBranch(e){this.openVersionDialog("createBranch",e)}createTag(e){this.openVersionDialog("createTag",e)}deleteBranch(e){this.openVersionDialog("deleteBranch",e)}deleteTag(e){this.openVersionDialog("deleteTag",e)}openVersionDialog(e,t){this.pageContext.getService("IVssContributionService").executeCommandEx("ms.vss-code-web.tags-version-dialog-actions-command",{dependencies:["ms.vss-code-web.version-dialogs-content"],serviceName:"IVersionDialogActionsService",methodName:e},t)}}const s="IReposActionService";function n(e){return e.getService(s)}function o(e,t){n(e).createBranch(t)}i.Services.add(s,{serviceFactory:r}),t[e].createBranch=o,t[e].createTag=function(e,t){n(e).createTag(t)},t[e].deleteBranch=function(e,t){n(e).deleteBranch(t)},t[e].deleteTag=function(e,t){n(e).deleteTag(t)},t[e].getDefaultCreateBranchAction=function(e,t,r){return()=>{const s=(0,f.getGitRepository)(e);o(e,Object.assign(Object.assign({},t),{onComplete:t=>{const i=e.getService("IReposRoutingService").getFilesUrl(s.name,s.project.name,r,(0,d.branchToVersionDescriptor)((0,v.refToBranchName)(t.name)));(0,l.FastPageSwitch)(e,i,!0)},repository:s}))}}}("ReposActionService"),function(){t.ReposShortcutsService={};class e extends i.VssService{_serviceStart(e){super._serviceStart(e),this.repository=(0,f.getGitRepository)(e),this.routingService=(0,y.getReposRoutingService)(this.pageContext)}gotoBranches(){const e=this.routingService.getBranchesUrl(this.repository.name,this.repository.project.name);(0,l.FastPageSwitch)(this.pageContext,e,!0)}gotoCommits(){const e=this.routingService.getCommitsUrl(this.repository.name,this.repository.project.name);(0,l.FastPageSwitch)(this.pageContext,e,!0)}gotoCreatePullRequest(){const e=this.routingService.getPullRequestCreateUrl(this.repository.name,this.repository.project.name);(0,l.FastPageSwitch)(this.pageContext,e,!0)}gotoFiles(){const e=this.routingService.getFilesUrl(this.repository.name,this.repository.project.name);(0,l.FastPageSwitch)(this.pageContext,e,!0)}gotoPullRequests(){const e=this.routingService.getPullRequestsUrl();(0,l.FastPageSwitch)(this.pageContext,e,!0)}}i.Services.add("IReposShortcutsService",{serviceFactory:e})}(),function(e){t[e]={};function r(e){return null==e?void 0:e.match("[‪-‮]|[⁦-⁩]")}t[e].detectBidiCharacterInLine=r,t[e].detectBidiCharacterInArray=function(e){return null==e?void 0:e.find(r)}}("UtilBidiDetector"),function(e){t[e]={};const r="VSTFS:",s="BUILD",i="BUILD";function n(e,t,n){if(t&&function(e){const t=(e=e.trim().toUpperCase()).split("/",6),[n,,,o,a,c]=t;return n===r&&o===s&&a===i&&!!c}(t)){return o(e,(0,g.decodeUri)(t).id,n)}return t}function o(e,t,r){const s={};return r&&(s.project=r),s.buildId=t,(0,u.routeUrl)(e,"ms.vss-build-web.ci-results-hub-route",s)}t[e].processGitStatusArtifactUris=function(e,t,r){if(!r)return[];for(const s of r){let r;if(s.description&&"["===s.description[0]){const e=s.description.indexOf("]");e>0&&(r=s.description.substring(1,e))}r||(r=t),s.targetUrl=n(e,s.targetUrl,r)}return r},t[e].convertArtifactUriToPublicBuildUrl=n,t[e].getBuildUrl=o}("UtilBuild"),function(e){function s(e){let t=0,s=0,i=0,n=0;for(const r of e)1&r?t++:2&r?s++:16&r?n++:8&r&&i++;const o=t+s+i+n,a=(0,r.format)(1===o?p.FileSummaryTotalFile:p.FileSummaryTotalFiles,o);if(0===o)return a;const c=[];return t>0&&c.push((0,r.format)(1===t?p.FileSummaryAddedFile:p.FileSummaryAddedFiles,t)),s>0&&c.push((0,r.format)(1===s?p.FileSummaryEditedFile:p.FileSummaryEditedFiles,s)),i>0&&c.push((0,r.format)(1===i?p.FileSummaryRenamedFile:p.FileSummaryRenamedFiles,i)),n>0&&c.push((0,r.format)(1===n?p.FileSummaryDeletedFile:p.FileSummaryDeletedFiles,n)),a+": "+c.join(", ")}t[e]={},t[e].getChangeSummaryText=function(e){return s(e.filter((e=>!e.item.isFolder)).map((e=>e.changeType)))},t[e].summarizeChangeTypes=s}("UtilChangeCounts"),function(e){t[e]={};const r={};function s(e){let t=r[e];if(void 0===t&&e){if(e){const r=[];128&e&&r.push(p.ChangeTypeMerge),1&e&&r.push(p.ChangeTypeAdd),64&e&&r.push(p.ChangeTypeBranch),16&e&&r.push(p.ChangeTypeDelete),!(4&e)||64&e||1&e||r.push(p.ChangeTypeFileType),256&e&&r.push(p.ChangeTypeLock),8&e&&r.push(p.ChangeTypeRename),32&e&&r.push(p.ChangeTypeUndelete),2&e&&!(1&e)&&r.push(p.ChangeTypeEdit),512&e&&r.push(p.ChangeTypeRollback),1024&e&&r.push(p.ChangeTypeSourceRename),4096&e&&r.push(p.ChangeTypeProperty),t=r.join(", ")}else t=p.ChangeTypeNone;r[e]=t}return t}t[e].getChangeTypeDisplayName=s,t[e].getDecorationText=function(e,t){let r="";return r=1&~e||!t?2===e||16===e?"":128===e?p.ChangeTypeMerge:64===e?p.ChangeTypeBranch:32===e?p.ChangeTypeUndelete:512===e?p.ChangeTypeRollback:4===e?p.ChangeTypeFileType:s(e):"+",r}}("UtilChangeType"),function(e){t[e]={},t[e].getShortCommitComment=function(e,t=80,s=!1){if(e){const i=(e=e.trim()).indexOf("\n");let n=!1,o=!1;i>0&&(e=(0,r.safeSubstring)(e,0,i),n=!0),e.length>t&&(e=(0,r.safeSubstring)(e,0,t-3).trim()+"...",o=!0),!o&&s&&n&&(e+="...")}return e},t[e].getArtifactUri=function(e,t,s){return(0,g.encodeUri)({id:(0,r.format)("{0}/{1}/{2}",e,t,s),tool:"Git",type:"Commit"})}}("UtilCommit"),function(e){function s(e){if(!e)return!1;const t=new Date;return Math.abs(t.getTime()-e.getTime())/36e5<24}t[e]={},t[e].isInLast24Hours=s,t[e].getDateStringWithFriendlyText=function(e){if(!e)return;const t=s(e),i=e.toLocaleString();return t?(0,r.format)("{0} ({1})",i,(0,m.ago)(e)):i},t[e].convertToEndOfDay=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)},t[e].convertToUtcEndOfDay=function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999))},t[e].convertToUtcStartOfDay=function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0))},t[e].applyLocalTimeZoneOffset=function(e){const t=new Date(e),r=t.getTime(),s=6e4*t.getTimezoneOffset();return new Date(r+s)}}("UtilDate"),function(e){t[e]={},t[e].getGitResourceUri=function(e,t,r){return`inmemory://model/git/${e}/${encodeURIComponent((0,d.getVersionString)(t))}${encodeURI(r)}`},t[e].getTfvcResourceUri=function(e,t){return`inmemory://model/tfvc/${encodeURIComponent((0,d.getTfvcVersionString)(e))}${encodeURI(t)}`}}("UtilEditor"),function(e){function s(e){const t=e.lastIndexOf(".");return t>=0?e.substr(t+1):""}t[e]={},t[e].getFileName=function(e){if(e){const t=e.lastIndexOf("/");return t>=0?e.substr(t+1):e}return""},t[e].getFileExtension=s,t[e].getIconNameForFile=function(e){switch(s(e).toLowerCase()){case"aspx":return"FileASPX";case"bat":case"cmd":return"Script";case"c":case"cc":case"h":case"hpp":case"cpp":case"cxx":return"CPlusPlusLanguage";case"coffee":case"litcoffee":return"CoffeeScript";case"cs":return"CSharpLanguage";case"css":return"FileCSS";case"doc":case"docx":return"WordDocument";case"fs":case"fsx":return"FSharpLanguage";case"htm":case"html":return"FileHTML";case"java":return"FileJAVA";case"js":return"JavaScriptLanguage";case"less":return"FileLess";case"md":case"markdown":case"mdown":return"MarkDownLanguage";case"pdb":return"FilePDB";case"ppt":case"pptx":return"PowerPointDocument";case"ps1":case"psm1":return"PowerShell";case"py":return"PythonLanguage";case"sass":return"FileSass";case"sln":return"FileTypeSolution";case"sql":return"FileSQL";case"ts":case"tsx":return"TypeScriptLanguage";case"xml":return"Embed";case"yml":case"yaml":return"FileYML";default:return"Page"}},t[e].getParentPath=function(e,t="/"){let r;const s=o(n(e,t));if(s){r=t;const e=s.lastIndexOf("/");e>=0&&(r+=s.substr(0,e))}return r};const i=new Set(['"',"/",":","<",">","\\","*","?"]);function n(e,t="/"){return e&&e.startsWith(t)?e.substr(t.length):e}function o(e){return e&&"/"===e[e.length-1]?e.substr(0,e.length-1):e}t[e].getInvalidFileNameMessage=function(e){return Array.from(e).some((e=>i.has(e)))?(0,r.format)(p.FileInvalidCharactersFormat,e):e.endsWith(".")||e.endsWith(" ")?(0,r.format)(p.FileInvalidEndCharactersFormat,e):void 0},t[e].trimLeadingSlash=n,t[e].trimTrailingSlash=o}("UtilFile"),function(e){t[e]={},t[e].getDisplayNameFromIdentity=function(e){if(e.isContainer){let t=e.displayName.lastIndexOf("\\");if(t<0&&(t=e.displayName.lastIndexOf("/")),t>=0&&e.displayName.length>t)return e.displayName.substring(t+1)}return e.displayName}}("UtilIdentity"),function(e){t[e]={},t[e].publishReposEvent=function(e,t,r){try{const s=e.getService("IVssTelemetryService"),i=e.getService("ITfsPageService").getData(),n=i&&i.project&&i.project.name,o=e.getService("IVCViewModelDataProviderService").getRepository(),a=o&&{gitRepositoryId:o.id,gitRepositoryName:o.name};s.publishEvent(h.CustomerIntelligence.Area,t,Object.assign(Object.assign({projectName:n},a),r))}catch(t){console.error(t),(0,c.traceException)(e,h.CustomerIntelligence.Area,"publishReposEvent",t)}}}("UtilTelemetry")}),["Resources","Constants","Util/Version","Util/Ref","VCViewModelDataProviderService","Permissions","ProjectRepositoryInformationService","ReposRoutingService","ReposActionService","ReposShortcutsService","Util/BidiDetector","Util/Build","Util/ChangeCounts","Util/ChangeType","Util/Commit","Util/Date","Util/Editor","Util/File","Util/Identity","Util/Telemetry"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-code-web.repos-common"}}));