"use strict";define("Tfs/Frame",["require","exports","react","VSS/Core/Observable","VSS/Platform/Layout","VSSUI/Expandable","VSSUI/Icon","VSSUI/Menu","VSSUI/Utilities/ScreenSize","VSS/Features/PlatformUI/ContributedItemUtil","VSS/Features/PlatformUI/ContributedMenu","VSSUI/Button","VSS/Features/PlatformUI/Components/ContributedIcon/ContributedIcon","VSSUI/ProgressBar","VSSUI/FocusZone","VSS/Platform/Context","VSS/Platform/Feature","VSSUI/Util","Tfs/Platform/DeviceType","VSS/Platform/Location","VSS/Platform/UserClaims","VSSUI/Observer","VSS/Features/PlatformUI/FPSLink","VSS/Core/Util/Screen","Tfs/Platform/Navigation","Tfs/Platform/ProjectPersona","VSS/Core/Util/String","VSS/Features/PlatformUI/ContributedIcon","VSS/Platform/FPS","VSSUI/Callout","VSSUI/FocusGroup","VSSUI/TooltipEx","VSSUI/Utilities/Focus","VSS/Features/Services/AccountMappingService","VSS/Features/Services/OrganizationsService","VSS/Platform/Util/Url","VSSUI/Link","VSS/Platform/Identity","VSSUI/VssPersona","Tfs/Platform/HeaderActions","VSSUI/Sizer"],(function(e,t,n,o,i,s,a,r,l,c,m,d,u,p,h,g,v,C,x,f,S,b,E,N,w,I,y,P,k,M,U,L,H,z,T,A,V,O,D,F,j){var R,G,_,W,B,K,Z,q,$,J;R=t[J="Resources"]={},t[J].AccessLevels="Access levels",t[J].AzureDevOpsProfile="Azure DevOps profile",t[J].AzureDevopsNavigationAriaLabel="Azure DevOps application",t[J].CollectionSettings="Collection Settings",t[J].BrandName="Azure",t[J].ChangeTheme="Change theme",t[J].Collections="Collections",t[J].Create="Create",t[J].Documentation="Documentation",t[J].GetHelp="Get help",t[J].Help="Help",t[J].HelpAndActions="Help and actions",t[J].LoadingProfileMenuItems="Loading profile menu items...",t[J].ManageUserSettings="Manage the currently logged in user settings",t[J].Marketplace="Marketplace",t[J].MoreOrganizations="{0} more organizations",t[J].MyOrgs="My organizations",t[J].MyWorkLabel="My Work",t[J].NavigationMenu="Expand navigation menu",t[J].NewOrg="New organization",t[J].NoActionsAvailable="No actions available",t[J].Notifications="Notifications",t[J].OneMoreOrganization="1 more organization",t[J].OrgSettings="Organization settings",t[J].PATPage="Personal access tokens",t[J].PermissionsRefresh="Permissions",t[J].Preferences="Time and Locale",t[J].PreviewFeatures="Preview features",t[J].ProjectNavigationAriaLabel="Project {0}",t[J].ProjectSettings="Project settings",t[J].ProductName="DevOps",t[J].Profile="Profile",t[J].RelatedPages="Related pages",t[J].SkipToMainContent="Skip to main content",t[J].ShowLess="Show less information",t[J].ShowMore="Show more information",t[J].SignIn="Sign in",t[J].SSHPublicKeys="SSH public keys",t[J].SuiteLogoLabel="Azure DevOps organization home page",t[J].SuiteLogoLabelOnPrem="Azure DevOps collection home page",t[J].TenantPicker="Switch directory",t[J].Theme="Theme",t[J].Usage="Usage",t[J].UserSettings="User settings",t[J].WhatsNew="What's new in DevOps",function(e){t[e]={};class d extends i.VssComponent{constructor(){super(...arguments),this.renderCallout=(e,t,i)=>{const s=(0,c.getContributedItems)(this.context.pageContext,"ms.vss-tfs-web.vertical-header-composite",void 0,"ms.vss-web.menu"),a=new o.ObservableCollection;for(const e of s){const t=(0,m.getMenuItems)(this.context.pageContext,e.id,void 0);for(const e of t.value)"service"!==e.groupKey&&"getting-started"!==e.groupKey||(e.groupKey="help");const n=t.value[0]&&t.value[0].groupKey,o=d.getMenuHeader(e,n||e.id);o&&a.push([o]),a.push(t)}return n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:i,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:"composite-menu",items:a},menuOrigin:{horizontal:"end",vertical:"start"}})}}static getMenuHeader(e,t){return e.contribution.title?{id:`header_${e.id}`,itemType:2,groupKey:t,text:e.contribution.title,rank:d.headerRanks[e.id]||50}:null}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e<=0},n.createElement(s.ExpandableContainer,{ariaLabel:R.HelpAndActions,className:"commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",renderCallout:this.renderCallout,role:"menuitem"},n.createElement(a.Icon,{iconName:"MoreVertical",size:"medium"})))}}t[e].Composite=d,d.headerRanks={"ms.vss-tfs-web.market-menu":20,"ms.vss-tfs-web.help-menu":30},i.VssComponent.register("ms.vss-tfs-web.composite",d)}("ComponentsCompositeComposite"),function(e){t[e]={};class o extends i.VssComponent{constructor(e,t){super(e,t),this.contributionMenuBarItems=[],this.onActivateExternal=e=>{if(e.uri){const t=this.context.pageContext.getService("IVssContributionService"),n={serviceName:e.registeredObjectId||e.id,uri:e.uri};t.getServiceEx(e.id,n,!0).then((e=>{e&&e.execute&&e.execute({})})).catch((t=>{console.warn(`Failed to execute external service for ${e.id}: ${t.toString()}`)}))}};const n=t.pageContext.getService("IVssContributionService"),o=n.getContributionChildren("ms.vss-tfs-web.vertical-header-menu-extension","ms.vss-web.action");null==o||o.forEach((e=>{const o=n.getContribution(e),i=o.icon?Object.assign({},(0,u.contributedIconToIconProps)(t.pageContext,e,o.icon,"")):{size:"medium",iconName:"ViewAll"};this.contributionMenuBarItems.push({id:e,title:o.title,icon:o.icon,uri:o.uri,registeredObjectId:o.registeredObjectId,iconProps:i})}))}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},this.contributionMenuBarItems.map((e=>n.createElement("div",{className:"flex-row flex-center",key:e.id},n.createElement(d.Button,{ariaLabel:e.title||"Extension",role:"menuitem",iconProps:e.iconProps,subtle:!0,tooltipProps:{text:e.title||"Extension"},onClick:()=>e.uri&&this.onActivateExternal(e)})))))}}t[e].HeaderMenuExtension=o,i.VssComponent.register("ms.vss-tfs-web.header-menu-extension",o)}("ComponentsHeaderMenuExtensionHeaderMenuExtension"),function(e){G=t[e]={};class s extends i.VssComponent{constructor(e,t){super(e,t),this.clearLoading=()=>{this.setState({loading:void 0})},this.startLoading=()=>{this.setState({loading:new o.ObservableValue(!0)})},this.setLoadingComplete=()=>{this.state.loading&&(this.state.loading.value=!1)},this.state={loading:new o.ObservableValue(!0)}}render(){return n.createElement(n.Fragment,null,this.props.children,void 0!==this.state.loading&&n.createElement(p.IndeterminateProgressBar,{className:"project-header-progress",loading:this.state.loading,loadingAnimationComplete:this.clearLoading}))}componentDidMount(){super.componentDidMount(),document.body.addEventListener("fpsLoading",this.startLoading),this.markCompletedAfterTTI()}componentWillUnmount(){super.componentWillUnmount();this.context.pageContext.getService("IVssContributionEventService").unsubscribe((()=>{this.setLoadingComplete()}),"page-rendered"),document.body.removeEventListener("fpsLoading",this.startLoading)}markCompletedAfterTTI(){this.context.pageContext.getService("IVssContributionEventService").subscribe((()=>{this.setLoadingComplete()}),"page-rendered")}}t[e].WithHeaderProgressBar=s}("ComponentsHeaderWithHeaderProgressBar"),function(){t.ComponentsHeaderProjectHeader={};class e extends n.Component{render(){return n.createElement(h.FocusZone,{circularNavigation:!0,direction:1,focusGroupProps:{defaultElementId:"suite-logo"}},n.createElement("div",{className:"project-header flex-row flex-noshrink",role:"banner"},n.createElement(G.WithHeaderProgressBar,null,n.createElement("div",{className:"flex-row flex-grow"},n.createElement(i.RegionComponent,{className:"flex-row flex-grow","aria-label":R.AzureDevopsNavigationAriaLabel,componentRegion:"header",role:"navigation"}),n.createElement(i.RegionComponent,{className:"flex-row flex-noshrink",componentRegion:"header-menubar",role:"menubar"})))))}}i.Components.add("ms.vss-tfs-web.frame.project-header",e)}(),function(){t.ComponentsHeaderTopLevelHeader={};class e extends i.VssComponent{render(){return n.createElement(h.FocusZone,{circularNavigation:!0,direction:1,focusGroupProps:{defaultElementId:"suite-logo"}},n.createElement("div",{className:"top-level-header flex-row flex-noshrink"},n.createElement(G.WithHeaderProgressBar,null,n.createElement(i.RegionComponent,{className:"flex-row flex-grow",componentRegion:"header"}),n.createElement(i.RegionComponent,{className:"flex-row flex-noshrink",componentRegion:"header-menubar",role:"menubar"}))))}}i.Components.add("ms.vss-tfs-web.frame.top-level-header",e)}(),function(){t.ComponentsHelpUserSettingsService={};class e extends g.VssService{expandUserSettingsMenu(){this.expandUserSettings()}setUserSettingsMenu(e){this.expandUserSettings=e}expandHelpMenu(){this.expandHelp()}setHelpMenu(e){this.expandHelp=e}}g.Services.add("IUserSettingsMenu",{serviceFactory:e})}(),function(e){_=t[e]={};t[e].MenuIcon=({onComponentRendered:e,iconName:t,tooltipProps:o})=>(n.useEffect((()=>{e&&e()})),n.createElement(a.Icon,{iconName:t,size:"medium",tooltipProps:o}))}("ComponentsHelpMenuIcon"),function(e){t[e]={};class o extends i.VssComponent{constructor(){super(...arguments),this.expandableContainerRef=n.createRef(),this.service=this.context.pageContext.getService("IUserSettingsMenu"),this.setHelpSettingsMenu=()=>{this.expandableContainerRef&&this.expandableContainerRef.current&&this.service.setHelpMenu(this.expandableContainerRef.current.expand)},this.renderCallout=(e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:"help-menu",items:(0,m.getMenuItems)(this.context.pageContext,"ms.vss-tfs-web.help-menu")},menuOrigin:{horizontal:"end",vertical:"start"}})}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(s.ExpandableContainer,{ref:this.expandableContainerRef,excludeFocusZone:!0,renderCallout:this.renderCallout,role:"menuitem"},n.createElement(d.Button,{ariaLabel:R.Help,className:"icon-only",subtle:!0,tooltipProps:{text:R.Help}},n.createElement(_.MenuIcon,{onComponentRendered:this.setHelpSettingsMenu,iconName:"Unknown"}))))}}t[e].Help=o,i.VssComponent.register("ms.vss-tfs-web.help",o)}("ComponentsHelpHelp"),function(e){t[e]={};const o="ms.vss-admin-web.user-admin-hub-route";class a extends i.VssComponent{constructor(){super(...arguments),this.service=this.context.pageContext.getService("IUserSettingsMenu"),this.expandableContainerRef=n.createRef(),this.setUserSettingsMenu=()=>{this.expandableContainerRef&&this.expandableContainerRef.current&&this.service.setUserSettingsMenu(this.expandableContainerRef.current.expand)},this.renderCallout=(e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:"user-settings-menu",items:this.getMenuItems()},menuOrigin:{horizontal:"end",vertical:"start"}}),this._showPreviewFeatures=()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("UserSettingsMenu","PreviewFeature",{Action:"Show Preview Features"});this.context.pageContext.getService("IVssContributionService").executeCommandEx("preview-feature",{methodName:"show",serviceName:"IFeaturePanel",dependencies:["ms.vss-tfs-web.feature-management-content"]})},this._showThemePanel=()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("UserSettingsMenu","ChangeTheme",{Action:"Show Theme Panel"});this.context.pageContext.getService("IVssContributionService").executeCommandEx("change-theme",{methodName:"show",serviceName:"IThemePanelService",dependencies:["ms.vss-tfs-web.theme-management-content","ms.vss-tfs-web.available-themes-data-provider"]})}}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(s.ExpandableContainer,{ref:this.expandableContainerRef,excludeFocusZone:!0,renderCallout:this.renderCallout,role:"menuitem"},n.createElement(d.Button,{ariaLabel:R.UserSettings,className:"icon-only",subtle:!0,tooltipProps:{text:R.UserSettings}},n.createElement(_.MenuIcon,{onComponentRendered:this.setUserSettingsMenu,iconName:"PlayerSettings"}))))}getMenuItems(){const e=this.context.pageContext.getService("IVssLocationService");let t=e.routeUrl(o,{adminPivot:"about"});const n=[];n.push({text:R.PreviewFeatures,rank:10,id:"previewFeatureLink",onActivate:this._showPreviewFeatures,iconProps:{iconName:"Preview",className:"admin-tab-icon"}}),n.push({id:"separator",itemType:1,rank:20}),n.push({text:R.Profile,rank:30,id:"profilePageLink",href:t,iconProps:{iconName:"ContactInfo",className:"admin-tab-icon"}}),t=e.routeUrl(o,{adminPivot:"preferences"}),n.push({text:R.Preferences,rank:40,id:"preferencesPageLink",href:t,iconProps:{iconName:"WorldClock",className:"admin-tab-icon"}});return(0,v.isFeatureFlagEnabled)(this.context.pageContext,"VisualStudio.Services.AdminEngagement.ProfileSettingsView.EnableRefreshPermissionsTab",!1)&&(t=e.routeUrl(o,{adminPivot:"permissionsRefresh"}),n.push({text:R.PermissionsRefresh,rank:45,id:"permissionsRefreshPageLink",href:t,iconProps:{iconName:"Refresh",className:"admin-tab-icon"}})),n.push({id:"separator",itemType:1,rank:50}),t=e.routeUrl(o,{adminPivot:"notifications"}),n.push({id:"notifications",href:t,rank:60,text:R.Notifications,iconProps:{iconName:"CannedChat",className:"admin-tab-icon"}}),n.push({text:R.Theme,rank:70,id:"changeThemeLink",onActivate:this._showThemePanel,iconProps:{iconName:"Color",className:"admin-tab-icon"}}),t=e.routeUrl(o,{adminPivot:"usage"}),n.push({id:"usage",href:t,rank:80,text:R.Usage,iconProps:{iconName:"ChartSeries",className:"admin-tab-icon"}}),n.push({id:"separator",itemType:1,rank:90}),t=e.routeUrl(o,{adminPivot:"tokens"}),n.push({id:"patPage",href:t,rank:100,text:R.PATPage,iconProps:{iconName:"Signin",className:"admin-tab-icon"}}),t=e.routeUrl(o,{adminPivot:"keys"}),n.push({id:"sshkeyPage",href:t,rank:110,text:R.SSHPublicKeys,iconProps:{iconName:"TwoKeys",className:"admin-tab-icon"}}),n}_initializeTelemetry(){this.telemetryService||(this.telemetryService=this.context.pageContext.getService("IVssTelemetryService"))}}t[e].UserSettings=a,i.VssComponent.register("ms.vss-tfs-web.user-settings",a)}("ComponentsHelpUserSettings"),function(e){t[e]={};class o extends i.VssComponent{constructor(){super(...arguments),this.renderCallout=(e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:t,items:(0,m.getMenuItems)(this.context.pageContext,"ms.vss-tfs-web.market-menu")},menuOrigin:{horizontal:"end",vertical:"start"}})}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(s.ExpandableContainer,{excludeFocusZone:!0,expandableId:"market-menu",renderCallout:this.renderCallout,role:"menuitem"},n.createElement(d.Button,{ariaLabel:R.Marketplace,iconProps:{size:"medium",iconName:"Shop"},subtle:!0,tooltipProps:{text:R.Marketplace}})))}}t[e].Market=o,i.VssComponent.register("ms.vss-tfs-web.market",o)}("ComponentsMarketMarket"),function(e){t[e]={};class o extends n.Component{constructor(){super(...arguments),this.renderDropdown=(e,t)=>n.createElement(i.WrappedComponent,{contentClassName:"flyout-my-work",defaultActiveElement:".bolt-tab",dependencies:["ms.vss-features.ui-layer-content"],id:t,modal:!1,onDismiss:e.collapse,wrappedType:"customPanel"},n.createElement(i.WrappedComponent,{wrappedType:"vertical-header-my-work-flyout"}))}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(s.ExpandableContainer,{excludeFocusZone:!0,expandableId:"my-work-panel",renderCallout:this.renderDropdown,role:"menuitem"},n.createElement(d.Button,{ariaLabel:R.MyWorkLabel,iconProps:{iconName:"CheckList"},subtle:!0,tooltipProps:{text:R.MyWorkLabel}})))}}t[e].MyWork=o,i.VssComponent.register("ms.vss-tfs-web.my-work",o)}("ComponentsMyWorkMyWork"),function(e){W=t[e]={};t[e].SwitchToDesktopButton=e=>{const t=e.context.pageContext.getService("IVssContributionService").getContribution("ms.vss-tfs-web.switch-to-desktop");return t?n.createElement(i.WrappedComponent,{dependencies:["ms.vss-tfs-web.mobile-content"],wrappedProps:{ariaLabel:t.ariaLabel,className:(0,C.css)(t.className,e.className),iconClassName:(0,C.css)(t.iconClassName,e.iconClassName),iconProps:Object.assign(Object.assign({},t.iconProps),{size:"medium"}),text:t.text,textClassName:(0,C.css)(t.textClassName,e.textClassName)},wrappedType:"ms.vss-tfs-web.switchToDesktopCommand"}):null}}("ComponentsNavigationSwitchToDesktopButton"),function(e){B=t[e]={};t[e].useFlyoutNavigation=(e,t)=>0===t||t<=2&&(0,x.getDeviceType)(e).phone}("UtilNavigation"),function(e){K=t[e]={};class o extends i.VssComponent{constructor(e,t){super(e,t),e.routeId&&(0,S.userHasClaim)(this.context.pageContext,"member")&&(this.href=(0,f.routeUrl)(this.context.pageContext,e.routeId));const n=t.pageContext.getService("IVssPageService").getData();if(this.isHosted=n.isHosted,this.props.alwaysExpanded)this.expanded=2;else{const e=t.pageContext.getService("ITfsNavigationService");this.expanded=e.getNavigationDisplayMode()}}render(){return n.createElement(N.ScreenContext.Consumer,null,(e=>n.createElement(b.Observer,{key:"suite-logo",expanded:this.expanded,size:e.size},(e=>n.createElement(n.Fragment,null,n.createElement("a",{href:"#skip-to-main-content",className:"skip-to-main-content bolt-button enabled bolt-focus-treatment"},R.SkipToMainContent),n.createElement(E.FPSLink,{ariaLabel:this.isHosted?R.SuiteLogoLabel:R.SuiteLogoLabelOnPrem,className:"commandbar-item suite-logo flex-row flex-noshrink flex-center",href:this.href,id:"suite-logo",telemetrySource:"applicationLink",removeUnderline:!0},n.createElement(a.Icon,{className:"suite-image commandbar-icon justify-center",iconName:"VSTSLogo"}),(2===e.expanded||this.props.alwaysExpanded||e.size<=0)&&n.createElement("span",{className:"brand body-m font-weight-heavy"},R.BrandName," ",R.ProductName)))))))}}t[e].SuiteLogo=o,i.VssComponent.register("ms.vss-tfs-web.suite-logo",o)}("ComponentsSuiteLogoSuiteLogo"),function(e){Z=t[e]={};class c extends i.VssComponent{constructor(e,t){super(e),this.navListRef=n.createRef(),this.checkAvailableNavigationHeight=e=>!(1===e&&!1!==this.props.collapse||this.props.collapse)||window.innerHeight>=this.navigationHeight+this.fixedElementHeight,this.onActivateMenuItem=(e,t)=>(0,k.onClickFPS)(this.context.pageContext,e.href,!0,t),this.onExpandedChange=e=>{const t=this.checkAvailableNavigationHeight(e);return t!==this.showHubs.value&&(this.showHubs.value=t),!0},this.onKeyDownToggle=e=>{e.defaultPrevented||32!==e.which&&13!==e.which||(this.props.onToggleExpand?this.props.onToggleExpand():this.toggleExpansion(),e.preventDefault())},this.onFpsLoading=e=>{if(e.detail&&e.detail.data&&e.detail.data.navigationId){const t=this.context.pageContext.getService("IVssNavigationService"),n=t.getNavigation(e.detail.data.navigationId);n&&n.parentId&&(this.displayedHubGroupId=n.parentId,this.displayedHubId=n.id,this.buildNavigationLists(t,this.displayedHubGroupCollectionId,this.displayedHubGroupId),this.forceUpdate())}},this.onResize=()=>{const e=this.checkAvailableNavigationHeight(this.expanded.value);e!==this.showHubs.value&&(this.showHubs.value=e)},this.onTransitionEnd=e=>{this.navListRef.current===e.target&&window.dispatchEvent(new CustomEvent("resize"))},this.renderMenuCell=(e,t,o)=>{if(1===e){const e=t.data;return n.createElement("div",{className:"bolt-menuitem-cell-content bolt-menuitem-cell-icon flex-row"},n.createElement(P.ContributedIcon,{alt:"",contributionId:e.id,icon:e.icon,iconAsset:e.iconAsset,iconName:e.iconName||"ViewAll",iconSize:"medium",pageContext:this.context.pageContext}))}},this.toggleExpansion=()=>{this.context.pageContext.getService("ITfsNavigationService").setNavigationDisplayMode(2===this.expanded.value?1:2);this.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","VerticalNavigation",{action:"vertical-nav-expanded",displayMode:this.expanded.value,hubsAreVisible:this.showHubs.value})},this.toggleExpandedHubGroup=(e,t,n)=>{if(t.preventDefault(),this.touchMoveCounter>5)return;if(n&&(this.showHubs.value=!0),this.expandedHubGroup===e)return this.expandedHubGroup="",void this.forceUpdate();this.expandedHubGroup=e;const o=this.context.pageContext.getService("IVssNavigationService");this.buildNavigationLists(o,this.displayedHubGroupCollectionId,this.expandedHubGroup),this.forceUpdate()},this.onTouchStart=()=>{this.touchMoveCounter=0},this.onTouchMove=()=>{this.touchMoveCounter++};const i=t.pageContext.getService("ITfsNavigationService");this.expanded=i.getNavigationDisplayMode();const s=t.pageContext.getService("ITfsPageService").getData();s&&s.project&&(this.projectName=s.project.name,this.projectImageUrl=s.project.imageUrl,this.settingsUrl=(0,f.routeUrl)(t.pageContext,"ms.vss-admin-web.project-admin-hub-route",{project:this.projectName})),this.userIsMember=(0,S.userHasClaim)(t.pageContext,"member");const a=t.pageContext.getService("IVssLayoutManager").getComponentsForRegion("footer");this.fixedElementHeight=144+(a&&a.length>0?22:0)+2+8+(this.userIsMember?48:0)+(this.settingsUrl?48:0);const r=t.pageContext.getService("IVssNavigationService"),l=r.getDisplayedNavigation();this.displayedHubGroupCollectionId=l[1],this.displayedHubGroupId=l[2],this.displayedHubId=l[3],this.expandedHubGroup=l[2],this.buildNavigationLists(r,this.displayedHubGroupCollectionId,this.displayedHubGroupId);let c=0;for(const e of this.hubGroups)c=Math.max(c,e.children.length);this.navigationHeight=48*this.hubGroups.length+40*c,this.showHubs=new o.ObservableValue(this.checkAvailableNavigationHeight(this.expanded.value))}render(){const{collapse:e,isCallout:t,onToggleExpand:i}=this.props;return n.createElement(b.Observer,{expanded:{filter:this.onExpandedChange,observableValue:this.expanded},showHubs:this.showHubs},(c=>{let d,u,p;return!1===e||void 0===e&&2===c.expanded?(u=R.ShowLess,p="DoubleChevronLeft",d="expanded"):(u=R.ShowMore,p="DoubleChevronRight",d="collapsed"),n.createElement(h.FocusZone,{circularNavigation:!0,direction:2,focusGroupProps:{defaultElementId:"create-action"},focusOnMount:t,handleTabKey:t,postprocessKeyStroke:()=>2},n.createElement("div",{className:(0,C.css)("project-navigation region-navigation flex-column flex-grow",d),"data-renderedregion":"navigation","aria-label":(0,y.format)(R.ProjectNavigationAriaLabel,this.projectName),ref:this.navListRef,role:"navigation",onTransitionEnd:this.onTransitionEnd},t&&n.createElement("div",{className:"region-header flex-row flex-noshrink"},n.createElement(K.SuiteLogo,{alwaysExpanded:!0,routeId:"ms.vss-tfs-web.suite-me-page-route"})),n.createElement("div",{className:"collapsible-section flex-noshrink"},n.createElement("div",{className:"project-item flex-row flex-grow flex-center scroll-hidden"},n.createElement("span",{className:"navigation-icon flex-row flex-center flex-noshrink justify-center"},n.createElement(I.ProjectPersona,{displayName:this.projectName,size:"small",url:this.projectImageUrl})),n.createElement("span",{className:"font-weight-heavy expanded-only flex-grow text-ellipsis"},this.projectName)),this.userIsMember&&this.projectName&&n.createElement(s.ExpandableContainer,{ariaLabel:R.Create,className:"focus-treatment alt-hover-effect flex-row cursor-pointer",expandableId:"ms.vss-tfs-web.vertical-header-create-menu",expandKey:39,id:"create-action",renderCallout:(e,t,i)=>{const s=(0,m.getMenuItems)(this.context.pageContext,"ms.vss-tfs-web.vertical-header-create-menu"),a=s,l=new o.ObservableArray;l.push({id:"no-actions-available",disabled:!0,itemType:2,text:R.NoActionsAvailable});const c=e=>{e.addedItems&&e.addedItems.length>0&&(l.value[0].hidden=!0,s.unsubscribe(c))};return this.setTimeout((()=>{0===s.length&&(a.push(l),s.subscribe(c))}),500),n.createElement(r.ContextualMenu,{anchorElement:i,anchorOrigin:{horizontal:"end",vertical:"start"},menuProps:{id:t,items:s},menuOrigin:{horizontal:"start",vertical:"start"},onDismiss:()=>{e.collapse(),s.unsubscribe(c)}})}},n.createElement(a.Icon,{className:"navigation-icon flex-row flex-center justify-center",iconName:"Add",size:"medium"}))),n.createElement("div",{className:"separator flex-row flex-noshrink"}),n.createElement("div",{className:(0,C.css)("navigation-section flex-column flex-grow scroll-hidden v-scroll-auto custom-scrollbar",(1===c.expanded&&!1!==e||!0===e)&&"custom-scrollbar-hidden"),role:"menubar",tabIndex:-1},this.hubGroups.map(((e,t)=>this.renderNavigation(e,!0,e.id===this.expandedHubGroup&&c.showHubs,0===t)))),n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement("div",{className:"separator flex-row flex-noshrink"})),n.createElement(W.SwitchToDesktopButton,{className:"flex-row flex-center",context:this.context,iconClassName:"navigation-icon flex-row flex-center flex-noshrink justify-center cursor-pointer",textClassName:"text-ellipsis"}),n.createElement("div",{className:"collapsible-section flex-noshrink"},this.userIsMember&&n.createElement(E.FPSLink,{className:(0,C.css)("hub stand-alone navigation-element navigation-link focus-treatment hover-effect flex-row flex-grow flex-center scroll-hidden relative","ms.vss-admin-web.project-admin-hub"===this.displayedHubId&&"displayed"),href:this.settingsUrl,id:"settings-link",telemetrySource:"vertical.settings",removeUnderline:!0},n.createElement(a.Icon,{ariaLabelledBy:"project-settings-text",className:"navigation-icon flex-row flex-center justify-center",iconName:"Settings",size:"medium"}),n.createElement("span",{className:"navigation-text expanded-only text-ellipsis",id:(0,C.getSafeId)("project-settings-text")},R.ProjectSettings)),n.createElement(l.ScreenSizeConditional,{condition:e=>e>0},n.createElement(U.FocusGroupContext.Consumer,null,(e=>n.createElement(h.FocusZoneContext.Consumer,null,(t=>n.createElement(L.Tooltip,{text:u},n.createElement("div",{"aria-label":u,className:"hub stand-alone focus-treatment alt-hover-effect flex-row","data-focuszone":t.focuszoneId,id:"project-expansion-toggle",onClick:i||this.toggleExpansion,onFocus:()=>{e.onFocus("project-expansion-toggle")},onKeyDown:this.onKeyDownToggle,role:"button",tabIndex:(0,H.getTabIndex)({id:"project-expansion-toggle"},e)},n.createElement(a.Icon,{className:"navigation-icon flex-row flex-center flex-noshrink justify-center cursor-pointer",iconName:p,size:"medium"})))))))))))}))}componentDidMount(){super.componentDidMount(),this.addEventListener(window,"resize",this.onResize),this.addEventListener(document.body,"fpsLoading",this.onFpsLoading)}buildNavigationLists(e,t,n){this.hubGroups=[],this.hubs=[];let o=e.getNavigation(t);if(o&&o.children)for(const e of o.children)32&~(e.flags||0)&&e.children&&e.children.length&&this.hubGroups.push(e);if(o=e.getNavigation(n),o&&o.children)for(const e of o.children)32&~(e.flags||0)&&this.hubs.push(e);this.hubGroups=this.sortNavigationList(this.hubGroups),this.hubs=this.sortNavigationList(this.hubs)}getMenuProps(e){const t=[];t.push({id:e.id,itemType:2,text:e.name});for(let n=0;n<e.children.length;n++){const o=e.children[n];t.push({data:o,id:o.id,href:o.href,onActivate:this.onActivateMenuItem,renderMenuCell:this.renderMenuCell,text:o.name})}return{id:"menu-"+e.id,items:t}}navigationComparer(e,t){return e.order===t.order?(0,y.localeIgnoreCaseComparer)(e.id,t.id):e.order-t.order}renderNavigation(e,t,o,i){const c=t?(0,C.css)("hub-group",e.id===this.displayedHubGroupId&&"displayed"):(0,C.css)("hub",e.id===this.displayedHubId&&"displayed"),m=t&&e.children&&e.children.length>1,d=m,u=m?o:void 0;let p,h=n.createElement("span",{className:"navigation-icon flex-row flex-center flex-noshrink justify-center"},n.createElement(P.ContributedIcon,{alt:"",contributionId:e.id,icon:e.icon,iconAsset:e.iconAsset,iconName:e.iconName||"ViewAll",iconSize:"medium",pageContext:this.context.pageContext}));return 1!==this.expanded.value&&!this.props.collapse||t&&1!==e.children.length||(h=n.createElement(L.Tooltip,{text:e.name},h)),t&&e.children.length>1&&(p=n.createElement(l.ScreenSizeConditional,{condition:e=>e<=1},n.createElement(a.Icon,{className:"touch-chevron justify-center flex-center",iconName:o?"ChevronUp":"ChevronDown",onClick:t=>this.toggleExpandedHubGroup(e.id,t),size:"small"}))),h=n.createElement(E.FPSLink,{ariaLabel:e.name,ariaHasPopup:d,ariaExpanded:u,className:(0,C.css)(c,"navigation-element navigation-link focus-treatment flex-row flex-grow flex-center scroll-hidden relative"),href:e.href,id:e.id+"-link",role:"menuitem",key:e.id,onClick:()=>{this.expandedHubGroup=!t&&e.parentId?e.parentId:e.id},onTouchEnd:t&&e.children.length>1?t=>this.toggleExpandedHubGroup(e.id,t,!0):void 0,onTouchMove:this.onTouchMove,onTouchStart:this.onTouchStart,navigationId:t?e.children[0].id:e.id,telemetrySource:"vertical.hub",tabIndex:i?0:void 0,removeUnderline:!0},h,n.createElement("span",{className:"navigation-text expanded-only text-ellipsis flex-grow"},e.name),p),t&&(e.children.length>1&&(o&&e.id===this.displayedHubGroupId||(h=n.createElement(s.ExpandableContainer,{className:"flex-row flex-noshrink",collapseDelay:90,expandKey:39,excludeFocusZone:!0,excludeTabStop:!0,expandableId:e.id,expandDelay:100,expandOnHover:!0,id:e.id+"-container",renderCallout:(t,o,i)=>n.createElement(r.ContextualMenu,{anchorElement:i,anchorOrigin:{horizontal:"end",vertical:"start"},menuProps:this.getMenuProps(e),menuOrigin:{horizontal:"start",vertical:"start"},onDismiss:t.collapse}),role:"none",ariaControls:"",ariaHasPopup:null,ariaExpanded:null},h)),o&&(h=n.createElement(n.Fragment,null,h,n.createElement("div",{role:"menu","arial-label":e.name},this.hubs.map((e=>this.renderNavigation(e,!1,!1))))))),h=n.createElement("div",{key:e.id,className:(0,C.css)("hub-group-container flex-column flex-noshrink relative",e.id===this.expandedHubGroup&&"expanded-container",e.id===this.displayedHubGroupId&&"displayed-container",(!o||e.children.length<=1)&&"hub-group-only")},h)),h}sortNavigationList(e){const t=[],n=[];for(const o of e)(0,w.isNavigationItemBuiltinOrTrusted)(o)?n.push(o):(0===o.order&&(o.order=100),t.push(o));return n.sort(this.navigationComparer),t.sort(this.navigationComparer),[...n,...t]}}class d extends i.VssComponent{constructor(e,t){super(e),this.collapseCallout=()=>{this.isCollapsing.value=!0},this.onAnimationEnd=()=>{this.isCollapsing.value&&this.props.closeCallout()},this.isCollapsing=new o.ObservableValue(!1);const n=t.pageContext.getService("IVssLayoutManager").getComponentsForRegion("footer");this.pageHasFooter=n&&n.length>0}render(){return n.createElement(b.Observer,{isCollapsing:this.isCollapsing},(e=>n.createElement(M.Callout,{anchorElement:document.body,anchorPoint:{x:0,y:0},calloutOrigin:{horizontal:"start",vertical:"start"},className:(0,C.css)("navigation-callout scroll-hidden",this.pageHasFooter&&"pageHasFooter"),contentClassName:"flex-column",lightDismiss:!0,escDismiss:!0,focuszoneProps:{focusOnMount:!0},modal:!0,onDismiss:this.collapseCallout},n.createElement("div",{className:(0,C.css)("nav-animation-container flex-row flex-grow scroll-hidden",e.isCollapsing&&"collapsing"),onAnimationEnd:this.onAnimationEnd},n.createElement(c,{isCallout:!0,onToggleExpand:this.collapseCallout,collapse:this.props.collapse})))))}}t[e].ProjectNavigationCallout=d;i.VssComponent.register("ms.vss-tfs-web.frame.project-navigation",(e=>{const t=new o.ObservableValue(!1),s=n.useContext(N.ScreenContext),a=(0,i.useComponentContext)().pageContext,r=()=>{t.value=!t.value};return n.createElement(b.Observer,{showPanel:t,size:s.size},(e=>!(0,B.useFlyoutNavigation)(a,e.size)&&n.createElement("div",{className:"navigation-container flex-column"},e.showPanel?n.createElement(n.Fragment,null,n.createElement("div",{className:"project-navigation region-navigation placeholder flex-column flex-grow flex-noshrink",role:"presentation"}),n.createElement(d,{collapse:!1,closeCallout:r})):n.createElement(c,{onToggleExpand:e.size<2?r:void 0,collapse:e.size<2||void 0}))))}))}("ComponentsNavigationProjectNavigation"),function(){t.ComponentsNavigationNavigationHeaderButton={};i.VssComponent.register("ms.vss-tfs-web.frame.navigation-header-button",(()=>{const e=(0,i.useComponentContext)().pageContext;return n.createElement(l.ScreenSizeConditional,{condition:t=>(0,B.useFlyoutNavigation)(e,t)},n.createElement(s.ExpandableContainer,{className:"navigation-header-button commandbar-item commandbar-icon flex-noshrink justify-center cursor-pointer",renderCallout:e=>n.createElement(Z.ProjectNavigationCallout,{collapse:!1,closeCallout:e.collapse}),tabIndex:0,expandKey:[13,32],ariaLabel:R.NavigationMenu},n.createElement(a.Icon,{iconName:"GlobalNavButton",size:"medium"})))}))}(),function(){t.ComponentsNavigationTopLevelNavigation={};class e extends i.VssComponent{constructor(e,t){super(e,t),this.showMoreLink=!0,this.isHosted=!0,this.renderListItem=e=>{const t="host-"+e.id;let o=(0,v.isFeatureFlagEnabled)(this.context.pageContext,"VisualStudio.Services.AdminEngagement.OrganizationOverview.EditableOrganizationAvatar",!1)&&e.avatarUrl?e.avatarUrl:void 0;return n.createElement(V.Link,{ariaSelected:e.id===this.displayedHostId,className:(0,C.css)("host-link navigation-link top-navigation-item focus-treatment flex-row flex-center flex-noshrink relative",e.id===this.displayedHostId&&"displayed"),href:e.url,id:t,key:t,role:"option",removeUnderline:!0},n.createElement(I.ProjectPersona,{displayName:e.name,size:"small",url:o}),n.createElement("span",{className:"text-ellipsis"},e.name))},this.updateCollectionList=e=>{const t=(0,f.getServiceLocation)(this.context.pageContext,void 0,1),n=e.map(((e,n)=>({id:e.id,name:e.name,url:(0,A.combineUrlPaths)(t,encodeURIComponent(e.name)),avatarUrl:e.avatarUrl})));n.sort(((e,t)=>e.id===this.displayedHostId?-1:t.id===this.displayedHostId?1:(0,y.localeIgnoreCaseComparer)(e.name,t.name))),this.state.collections.push(...n)},this.updateNewOrgUrl=e=>{if(e){const t=new A.Uri(e);t.addQueryParam("campaign","o~msft~vsts~orghome",!0),this.state.newOrgLink.value=t.absoluteUri}},this.showAllHostsClicked=()=>{this.showMoreLink=!1,this.updateOrganizationList()},this.updateOrganizationList=()=>{let e=this.allOrganizations;if(this.mruOrganizations){const t=[];let n=!1;e=[];for(const o of[...this.mruOrganizations,...this.allOrganizations])if(t.indexOf(o.id)<0&&(t.push(o.id),o.id===this.displayedHostId?(e.unshift(o),n=!0):e.push(o),n&&this.showMoreLink&&e.length>=4))break}const t=this.showMoreLink&&e.length>4?e.slice(0,4):e;this.state.organizations.splice(0,this.state.organizations.length,...t)};const i=t.pageContext.getService("IVssPageService").getData();if(this.displayedHostId=i.hostId,this.isHosted=i.isHosted,!this.isHosted){if(t.pageContext.getService("IVssSecurityService").hasPermission("1f4179b3-6bac-4d01-b421-71ea09171400","FrameworkGlobalSecurity",2)){const e=(0,f.getServiceLocation)(t.pageContext,void 0,1);this.accessLevelsLink=(0,f.routeUrl)(t.pageContext,"ms.vss-admin-web.admin-access-levels-route",{},e)}}if(this.settingsLink=(0,f.routeUrl)(t.pageContext,"ms.vss-admin-web.collection-admin-hub-route"),this.state={collections:new o.ObservableArray([]),newOrgLink:new o.ObservableValue(void 0),organizations:new o.ObservableArray([])},this.isHosted)this.trackPromise(Promise.all([(0,T.getMostRecentlyAccessedUserOrganizations)(t.pageContext),(0,T.getUserOrganizations)(t.pageContext)])).promise.then((e=>{this.mruOrganizations=e[0],this.allOrganizations=e[1],this.updateOrganizationList()})),this.trackPromise((0,T.getNewOrganizationUrl)(t.pageContext)).promise.then(this.updateNewOrgUrl);else{const e=t.pageContext.getRestClient("ICoreRestClient",{hostType:1});this.trackPromise(e.getProjectCollections(1e3)).promise.then(this.updateCollectionList)}}componentDidMount(){this.isHosted&&this._queueSyncUserAccountMapping()}render(){return n.createElement(l.ScreenSizeConditional,{condition:e=>this.props.showAlways||!(0,B.useFlyoutNavigation)(this.context.pageContext,e)},n.createElement("div",{className:(0,C.css)(this.props.className,"top-level-navigation region-navigation flex-column flex-noshrink scroll-hidden expanded"),role:"navigation"},n.createElement("div",{className:"top-level-section scroll-hidden flex-column flex-grow"},n.createElement(b.Observer,{hosts:this.isHosted?this.state.organizations:this.state.collections},(e=>e.hosts.length?n.createElement(h.FocusZone,{direction:2,focusGroupProps:{defaultElementId:"host-"+e.hosts[0].id}},n.createElement("div",{className:"flex-column v-scroll-auto h-scroll-hidden custom-scrollbar",role:"listbox","aria-label":R.MyOrgs},e.hosts.map(this.renderListItem)),this.isHosted&&n.createElement("div",{className:"action-section flex-column flex-noshrink"},this.allOrganizations&&this.allOrganizations.length-e.hosts.length>0?n.createElement(V.Link,{className:"action-link top-navigation-item focus-treatment flex-row flex-noshrink",onClick:this.showAllHostsClicked},this.allOrganizations.length-e.hosts.length==1?R.OneMoreOrganization:(0,y.format)(R.MoreOrganizations,this.allOrganizations.length-e.hosts.length)):null,n.createElement(b.Observer,{newOrgUrl:this.state.newOrgLink},(e=>e.newOrgUrl?n.createElement(V.Link,{className:"action-link top-navigation-item focus-treatment flex-row flex-noshrink",href:e.newOrgUrl,id:"new-org-link"},R.NewOrg):null)))):null))),n.createElement("div",{className:"announcements-section flex-column flex-noshrink"},n.createElement(i.WrappedComponent,{wrappedType:"globalAnnouncement",dependencies:["ms.vss-tfs-web.suite-me-page-content"]})),this.isHosted?null:n.createElement("div",{className:"related-pages-section flex-column flex-noshrink"},n.createElement("span",{className:"section-header"},R.RelatedPages),this.isHosted&&n.createElement("span",{className:"related-link"},n.createElement(V.Link,{className:"link-text",href:"https://docs.microsoft.com/en-us/azure/devops/release-notes/"},R.WhatsNew)),n.createElement("span",{className:"related-link"},n.createElement(V.Link,{className:"link-text",href:"https://docs.microsoft.com/en-us/azure/devops/?view=azdevops"},R.Documentation)),n.createElement("span",{className:"related-link"},n.createElement(V.Link,{className:"link-text",href:"https://azure.microsoft.com/en-us/support/devops/"},R.GetHelp)),this.accessLevelsLink&&n.createElement("span",{className:"related-link"},n.createElement(V.Link,{className:"link-text",href:this.accessLevelsLink},R.AccessLevels))),n.createElement("div",{className:"navigation-footer"},n.createElement(E.FPSLink,{className:"action-link navigation-link focus-treatment top-navigation-item flex-row",href:this.settingsLink,id:"settings-link",removeUnderline:!0},n.createElement(a.Icon,{className:"icon-margin",iconName:"Settings",size:"medium"}),n.createElement("span",{className:"text-ellipsis"},this.isHosted?R.OrgSettings:R.CollectionSettings)),n.createElement(W.SwitchToDesktopButton,{className:"action-link top-navigation-item",context:this.context,iconClassName:"icon-margin",textClassName:"text-ellipsis"}))))}async _queueSyncUserAccountMapping(){if(await(0,T.isUserAccountMappingRequired)(this.context.pageContext)&&(await(0,z.queueSyncUserAccountMapping)(this.context.pageContext),(0,v.isFeatureFlagEnabled)(this.context.pageContext,"VisualStudio.Services.AdminEngagement.OrganizationNavigation.AccountMappingWhenOrgDiscrepancy",!1))){const e=await this.context.pageContext.getService("IVssPageService"),t=await e.getData();t&&await(0,z.activateMapping)(this.context.pageContext,t.user.descriptor,t.hostId)}}}i.Components.add("ms.vss-tfs-web.frame.top-level-navigation",e);i.VssComponent.register("ms.vss-tfs-web.frame.top-navigation-header-button",(()=>{const t=(0,i.useComponentContext)().pageContext;return n.createElement(l.ScreenSizeConditional,{condition:e=>(0,B.useFlyoutNavigation)(t,e)},n.createElement(s.ExpandableContainer,{className:"navigation-header-button commandbar-item commandbar-icon flex-noshrink justify-center cursor-pointer",renderCallout:t=>n.createElement(M.Callout,{className:"absolute-fill",contentClassName:"flex-column",lightDismiss:!0,escDismiss:!0,modal:!0,onDismiss:t.collapse,focuszoneProps:{focusOnMount:!0}},n.createElement("div",{className:"region-header flex-row flex-noshrink"},n.createElement(K.SuiteLogo,{alwaysExpanded:!0})),n.createElement(e,{className:"flex-grow",showAlways:!0})),tabIndex:0,expandKey:[13,32],ariaLabel:R.NavigationMenu},n.createElement(a.Icon,{iconName:"GlobalNavButton",size:"medium"})))}))}(),function(){t.ComponentsProfileServiceMeControlService={};class e extends g.VssService{constructor(){super(...arguments),this._showChangeTenants=()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("MeControl","TenantPicker",{Action:"Show Tenant Picker"});this.pageContext.getService("IVssContributionService").executeCommandEx("change-tenants",{methodName:"show",serviceName:"ITenantPickerPanel",dependencies:["ms.vss-tfs-web.tenant-picker-content"]})},this._showUserSettings=()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("MeControl","UserSettings",{Action:"Show User Settings"});this.pageContext.getService("IVssContributionService").executeCommandEx("show-user-settings-header-menu",{methodName:"expandUserSettingsMenu",serviceName:"IUserSettingsMenu",dependencies:[]})},this._showHelp=()=>{this._initializeTelemetry(),this.telemetryService.publishEvent("MeControl","HelpMenu",{Action:"Show Help Menu"});this.pageContext.getService("IVssContributionService").executeCommandEx("show-help-header-menu",{methodName:"expandHelpMenu",serviceName:"IUserSettingsMenu",dependencies:[]})}}getConfigurations(e,t){const n=this.pageContext.getService("IVssThemeService").getCurrentTheme();return{apiGeneration:"GEN2",containerId:"me-control-container",currentAccount:e.currentAccount.isAnonymous?void 0:{type:!0===e.currentAccount.isMsaOrFpmsa?"msaFed":"aad",memberName:e.currentAccount.email,displayName:e.currentAccount.name,orgName:e.currentAccount.aadTenantDisplayName,pictureUrl:t,authenticatedState:"signedIn",profile:{profileName:e.currentAccount.name,profilePictureUrl:t,editProfilePictureUrl:""}},authProviderConfig:{type:"webAadWithMsaFed",appSignInUrl:e.authProviderConfig.signInUrl,appSignInToUrl:e.authProviderConfig.signInToUrl,appSignOutUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.signOutUrl,appSwitchUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.switchUrl,appSwitchToUrl:e.currentAccount.isAnonymous?"":e.authProviderConfig.switchToUrl,aad:{signOutUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpSignOutUrl,signOutAndForgetUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpSignOutAndForgetUrl,forgetUrl:e.currentAccount.isAnonymous?"":e.aadIdpConfig.aadIdpForgetUrl,rememberedAccountsUrl:e.aadIdpConfig.aadIdpRememberedAccountsUrl}},primaryUXConfig:e.currentAccount.isAnonymous?"":{displayModes:[{type:"compressed",widthBreakpoint:5e3}],theme:{type:n.isDark?"dark":"light"}},appContextConfig:e.currentAccount.isAnonymous?"":{commands:this.getCommands(e)}}}getCommands(e){const t=[];return(0,v.isFeatureFlagEnabled)(this.pageContext,"VisualStudio.Services.AdminEngagement.MeControl.MeControlTenantPicker",!1)||t.push({text:R.AzureDevOpsProfile,id:"userSettingsLink",ariaLabel:R.AzureDevOpsProfile,openInNewTab:!0,url:e.profileUrl,type:"link"}),(0,v.isFeatureFlagEnabled)(this.pageContext,"VisualStudio.Services.AdminEngagement.MeControl.MeControlTenantPicker",!1)&&t.push({text:R.TenantPicker,id:"tenantPickerLink",ariaLabel:R.TenantPicker,openInNewTab:!1,type:"link",onClick:this._showChangeTenants}),t.push({text:R.Help,id:"showHelp",ariaLabel:R.Help,openInNewTab:!1,type:"link",onClick:this._showHelp}),t.push({text:R.UserSettings,id:"showUserSettings",ariaLabel:R.UserSettings,openInNewTab:!1,type:"link",onClick:this._showUserSettings}),t}_initializeTelemetry(){this.telemetryService||(this.telemetryService=this.pageContext.getService("IVssTelemetryService"))}}g.Services.add("IMeControlService",{serviceFactory:e})}(),function(e){q=t[e]={},function(e){e.LoadScriptScenario="LoadMeControlScriptScenario",e.Area="MeControl",e.LoadScriptFeature="LoadMeControlScript",e.LoadScriptFailAction="Load me control script failure",e.LoadComponentFeature="LoadMeControlComponent",e.LoadComponentFailAction="Load me control component failure"}(t[e].MeControlConstants||(t[e].MeControlConstants={}))}("ComponentsProfileUtilMeControlConstants"),function(e){t[e]={};class o extends i.VssComponent{constructor(e,t){super(e,t),this._onSelectedThemeChanged=e=>{const t=window.MeControl;t&&t.API&&t.API.setTheme({type:e.isDark?"dark":"light"})},this._onLoadMeControlScript=()=>{const e=this.context.pageContext.getService("IVssContentService"),t=this.context.pageContext.getService("IVssPerformanceService"),n=this.context.pageContext.getService("IVssTelemetryService");if(this.state.data.meControlScriptUrl){const o={url:this.state.data.meControlScriptUrl,contentLength:16e3,clientId:"me-control-script",contributionId:"vertical-header-profile",contentType:"text/javascript"};t.startScenario(q.MeControlConstants.LoadScriptScenario,!1),e.loadScripts([o]).then((e=>{t.endScenario(q.MeControlConstants.Area,q.MeControlConstants.LoadScriptScenario,!1),this._loadMeControlComponent(n)}),(e=>{t.endScenario(q.MeControlConstants.Area,q.MeControlConstants.LoadScriptScenario,!1,void 0,{status:"failed"}),n.publishEvent(q.MeControlConstants.Area,q.MeControlConstants.LoadScriptFeature,{Action:q.MeControlConstants.LoadScriptFailAction,ErrorMessage:JSON.stringify(e)})}))}},this._loadMeControlComponent=e=>{try{window.MeControl.Loader.load(this.state.configDetails)?this.themeService.subscribe(this._onSelectedThemeChanged,"themeChanged"):e.publishEvent(q.MeControlConstants.Area,q.MeControlConstants.LoadComponentFeature,{Action:q.MeControlConstants.LoadComponentFailAction})}catch(e){console.error(e)}};const n=t.pageContext.getService("IVssPageService").getData(),o=this.context.pageContext.getService("IVssContributionService").getData("ms.vss-tfs-web.vertical-header-me-control-data-provider");let i="";n&&n.user&&(i=(0,O.getIdentityImageUrl)(t.pageContext,n.user,2)+"&"+(new Date).getTime()),this.themeService=this.context.pageContext.getService("IVssThemeService");const s=this.context.pageContext.getService("IMeControlService");this.state={data:o,configDetails:s.getConfigurations(o,i)}}render(){return n.createElement("div",{className:"me-control-div commandbar-item commandbar-icon flex-row flex-noshrink "+(this.state.data&&this.state.data.currentAccount.isAnonymous?"sign-in":""),role:"menuitem"},n.createElement("div",{id:"me-control-container"},n.createElement("span",null,R.LoadingProfileMenuItems)))}componentDidMount(){super.componentDidMount(),this.state.data&&this._loadMeControlScriptAfterTTI()}componentWillUnmount(){super.componentWillUnmount();this.context.pageContext.getService("IVssContributionEventService").unsubscribe(this._onLoadMeControlScript,"page-rendered"),this.themeService.unsubscribe(this._onSelectedThemeChanged,"themeChanged");try{const e=document.getElementById("me-control-container");if(e){const t=e.getElementsByClassName("mectrl_root");if(1==(null==t?void 0:t.length)){const e=t[0]._component;e&&this.unmountComponent(e)}}}catch(e){console.error(e)}}unmountComponent(e){let t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;let n=e._component;n?this.unmountComponent(n):t&&(e.nextBase=t,this.removeNode(t),this.removeChildren(t)),this.applyRef(e.__ref,null)}removeNode(e){let t=e.parentNode;t&&t.removeChild(e)}removeChildren(e){for(e=e.lastChild;e;){let t=e.previousSibling;this.recollectNodeTree(e),e=t}}recollectNodeTree(e){let t=e._component;t?this.unmountComponent(t):this.removeChildren(e)}applyRef(e,t){e&&("function"==typeof e?e(t):e.current=t)}_loadMeControlScriptAfterTTI(){if(window.MeControl){const e=this.context.pageContext.getService("IVssTelemetryService");this._loadMeControlComponent(e)}else{this.context.pageContext.getService("IVssContributionEventService").subscribe(this._onLoadMeControlScript,"page-rendered")}}}t[e].MeControl=o,i.VssComponent.register("ms.vss-tfs-web.me-control",o)}("ComponentsProfileMeControl"),function(e){t[e]={};class o extends i.VssComponent{constructor(e,t){super(e,t),this.renderDropdown=(e,t,o)=>n.createElement(r.ContextualMenu,{onDismiss:e.collapse,anchorElement:o,anchorOrigin:{horizontal:"end",vertical:"end"},menuProps:{id:t,items:(0,m.getMenuItems)(this.context.pageContext,"ms.vss-tfs-web.profile-menu")},menuOrigin:{horizontal:"end",vertical:"start"}});const o=t.pageContext.getService("IVssPageService").getData();o&&o.user&&(this.displayName=o.user.displayName,this.imageUrl=(0,O.getIdentityImageUrl)(t.pageContext,o.user,1))}render(){return n.createElement(s.ExpandableContainer,{className:"navigation-profile-menu commandbar-item commandbar-icon cursor-pointer flex-row flex-noshrink justify-center",expandableId:"profile-menu",role:"menuitem",renderCallout:this.renderDropdown},n.createElement(D.VssPersona,{imgAltText:R.ManageUserSettings,size:"small",suppressPersonaCard:!0,identityDetailsProvider:{getIdentityImageUrl:e=>this.imageUrl,getDisplayName:()=>this.displayName||""}}))}}t[e].Profile=o,i.VssComponent.register("ms.vss-tfs-web.profile",o)}("ComponentsProfileProfile"),function(e){t[e]={};class o extends i.VssComponent{constructor(e,t){super(e,t);const n=(0,F.getHeaderActionData)(t.pageContext)||{};this.state={signInUrl:n.signInUrl}}render(){return n.createElement(V.Link,{className:"sign-in-link commandbar-item",href:this.state.signInUrl},R.SignIn)}}t[e].SignInLink=o,i.VssComponent.register("ms.vss-tfs-web.sign-in-link",o)}("ComponentsSignInSignIn"),function(){t.ComponentsUserMenuItemUserMenuItem={};class e extends i.VssComponent{constructor(e,t){super(e,t);const n=t.pageContext.getService("IVssPageService").getData();n&&n.user&&(this.userDisplayName=n.user.displayName,this.userUniqueName=n.user.uniqueName,this.userImageUrl=(0,O.getIdentityImageUrl)(t.pageContext,n.user,1))}render(){return n.createElement("tr",{"aria-posinset":this.props.details.position,"aria-setsize":this.props.details.setSize,className:"bolt-menuitem-row bolt-list-row user-menuitem-row",role:"presentation"},n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}),n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell",colSpan:5},n.createElement("div",{className:"flex-row flex-center"},n.createElement("img",{className:"user-menu-item-image",src:this.userImageUrl,alt:""}),n.createElement("div",{className:"user-menu-item-details"},n.createElement("div",null,this.userDisplayName),n.createElement("div",{className:"user-menu-item-unique-name"},this.userUniqueName)))),n.createElement("td",{className:"bolt-menuitem-cell bolt-list-cell"}))}}i.Components.add("userMenuItem",e)}(),function(e){$=t[e]={},function(e){e.ToggleContentSplitterFarContent="ToggleContentSplitterFarContent"}(t[e].IContentSplitterEventType||(t[e].IContentSplitterEventType={}));class n extends g.VssObservableService{fireEvent(e,t){this._notify(e,t)}}t[e].contentSplitterEventServiceName="IContentSplitterEventService",g.Services.add(t[e].contentSplitterEventServiceName,{serviceFactory:n})}("ComponentsContentSplitterContentSplitterEventService"),function(e){t[e]={};class s extends i.VssComponent{constructor(e,t){super(e,t),this.childContributionData=new o.ObservableValue(null),this.sizerSize=new o.ObservableValue(400),this.onSize=(e,t)=>{this.sizerSize.value=t},this.onContributionDataChange=e=>{this.childContributionData.value=this.childContributionData.value?null:e.data,this.sizerSize.value=e.data.componentProperties.initialWidth},this.contentSplitterEventService=t.pageContext.getService($.contentSplitterEventServiceName),this.contentSplitterEventService.subscribe(this.onContributionDataChange,$.IContentSplitterEventType.ToggleContentSplitterFarContent)}render(){return n.createElement(b.Observer,{childContributionData:this.childContributionData,size:this.sizerSize},(e=>{const t=e.childContributionData;return t&&n.createElement(n.Fragment,null,n.createElement(j.Sizer,{className:"bolt-content-aside-sizer",divider:!0,keyboardStepMultiplier:24,maxSize:800,minSize:400,onSize:this.onSize,orientation:0,position:1,size:e.size}),n.createElement("div",{className:"content-splitter flex-noshrink flex-row flex-grow",style:{maxWidth:e.size}},n.createElement(i.WrappedComponent,Object.assign({wrappedType:t.componentType},t.componentProperties))))}))}componentWillUnmount(){this.contentSplitterEventService.unsubscribe(this.onContributionDataChange,$.IContentSplitterEventType.ToggleContentSplitterFarContent)}}t[e].ContentSplitter=s,i.VssComponent.register("ms.vss-tfs-web.content-splitter",s)}("ComponentsContentSplitterContentSplitter")}),["Resources","Components/Composite/Composite","Components/HeaderMenuExtension/HeaderMenuExtension","Components/Header/WithHeaderProgressBar","Components/Header/ProjectHeader","Components/Header/TopLevelHeader","Components/Help/UserSettingsService","Components/Help/MenuIcon","Components/Help/Help","Components/Help/UserSettings","Components/Market/Market","Components/MyWork/MyWork","Components/Navigation/SwitchToDesktopButton","Util/Navigation","Components/SuiteLogo/SuiteLogo","Components/Navigation/ProjectNavigation","Components/Navigation/NavigationHeaderButton","Components/Navigation/TopLevelNavigation","Components/Profile/Service/MeControlService","Components/Profile/Util/MeControlConstants","Components/Profile/MeControl","Components/Profile/Profile","Components/SignIn/SignIn","Components/UserMenuItem/UserMenuItem","Components/ContentSplitter/ContentSplitterEventService","Components/ContentSplitter/ContentSplitter"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.frame-content"}}));