"use strict";define("Wit/Common/TeamServices",["require","exports","VSS/Core/Observable","VSS/Platform/Context","Wit/Clients/Work/RestClient/Work"],(function(e,t,a,i,s){!function(){var e;t.TeamSettingsService={},function(e){e.TeamSettingsDataProvider="ms.vss-work-web.new-team-wit-settings-data-provider"}(e||(e={}));class r extends i.VssService{constructor(){super(...arguments),this.updateTeamSettings=(e,t)=>{var a,i;const r=(0,s.getWorkClient)(this.pageContext),o=this.pageContext.getService("ITfsPageService").getData(),c=null!==(i=null===(a=null==o?void 0:o.project)||void 0===a?void 0:a.id)&&void 0!==i?i:"";return r.updateTeamSettings(e,{teamId:t,projectId:c}).then((e=>{var t;(null===(t=this.teamDataCache)||void 0===t?void 0:t.value)&&(this.teamDataCache.value=Object.assign(Object.assign({},this.teamDataCache.value),{backlogVisibilities:e.backlogVisibilities,weekends:{canEditWeekends:this.teamDataCache.value.weekends.canEditWeekends,days:n(e.workingDays)},bugsBehavior:Number(e.bugsBehavior)}))}))},this.teamSettingsCache=new Map,this.getTeamSettingsById=(t,a)=>{if(!a&&this.teamSettingsCache.has(t))return Promise.resolve(this.teamSettingsCache.get(t));return this.pageContext.getService("IVssContributionService").getDataAsync(e.TeamSettingsDataProvider,{teamId:t},a)}}_serviceStart(e){super._serviceStart(e)}getTeamSettings(t){var i;if(!t&&(null===(i=this.teamDataCache)||void 0===i?void 0:i.value))return Promise.resolve(this.teamDataCache.value);if(t||!this.teamDataPromise){const i=this.pageContext.getService("IVssContributionService");this.teamDataPromise=i.getDataAsync(e.TeamSettingsDataProvider,{},t).then((e=>(this.teamDataCache?this.teamDataCache.value=e:this.teamDataCache=new a.ObservableValue(e),e)))}return this.teamDataPromise}getTeamSettingsObservable(e){return!e&&this.teamDataCache||(this.teamDataCache||(this.teamDataCache=new a.ObservableValue(void 0)),this.getTeamSettings(e)),this.teamDataCache}async getTeamIterationData(e,t){const a=await this.getTeamSettings(t);if(!a)return;const{previousIterations:i=[],futureIterations:s=[],currentIteration:r}=a;return[...i,...r?[r]:[],...s].find((t=>t.friendlyPath===e))}}function n(e){const t={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0};return e.forEach((e=>t[e]=!1)),Object.keys(t).filter((e=>t[Number(e)])).map((e=>Number(e)))}i.Services.add("ITeamSettingsService",{serviceFactory:r})}()}),["TeamSettingsService"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-work-web.common-team-services"}}));