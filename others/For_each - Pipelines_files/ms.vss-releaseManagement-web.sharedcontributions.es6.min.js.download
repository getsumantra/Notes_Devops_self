"use strict";define("Release/Sharedcontributions",["require","exports","react","VSS/Legacy/Legacy","VSS/Platform/Layout","VSS/Platform/Context","react-dom","VSS/Core/Observable","VSS/Platform/Components/Format","VSS/Platform/Location"],(function(e,t,n,r,s,i,a,o,c,l){var u,m;u=t[m="Resources"]={},t[m].ConcurrencyMessageFormat="Weâ€™ll soon resume enforcing limits on parallel jobs run by self-hosted agents. To learn more, see {0} and {1}.",t[m].ConcurrencyDocumentLinkName="our documentation",t[m].CocurrentJobLimitsLinkName="view your limits",t[m].ConcurrencyDocumentLink="https://aka.ms/concurrency-limits",t[m].Release="Release",function(){t.ReleaseMenuService={};class e extends i.VssService{constructor(){super(),this._prefetchCreateReleasePanel=()=>{const e=document.createElement("div");let t=n.createElement(s.ReactRootComponent,{pageContext:this.pageContext},n.createElement(r.LegacyComponent,{modules:["ReleasePipeline/Scripts/TFS.ReleaseManagement.BuildIntegration","PipelineWorkflow/Scripts/SharedComponents/CreateRelease/CreateReleaseExtension","PipelineWorkflow/Scripts/Shared/LegacyLWP/PrefetchPipelineWorkFlow"],wrappedType:"prefetch-create-release-panel",dependentContributionIds:["ms.vss-releaseManagement-web.release-service-data-external"],dependencies:["ms.vss-web.legacy-vss-ui-content","ms.vss-work-web.common-content"]}));a.render(t,e)},setTimeout((()=>{this._prefetchCreateReleasePanel()}),500)}loadItems(e,t){}createRelease(e){const t=this.pageContext.getService("IVssPerformanceService"),s="CD",i="VSO.CD.OpenCreateReleaseDialog";t.startScenario(i,!0);this.pageContext.getService("IVssLayoutManager").renderCallout((()=>n.createElement(r.LegacyComponent,{modules:["ReleasePipeline/Scripts/TFS.ReleaseManagement.BuildIntegration"],wrappedType:"createReleaseDialog",dependentContributionIds:["ms.vss-releaseManagement-web.release-service-data-external"],buildDetails:e,endPerfScenario:()=>t.endScenario(s,i,!0),vssPageContext:this.pageContext},null)))}}i.Services.add("release-menu-service",{serviceFactory:e})}(),function(e){t[e]={};class n extends i.VssService{constructor(){super(...arguments),this._items=new o.ObservableArray}_serviceStart(e){super._serviceStart(e),this._releaseDefinitionProvider=e.getService("IBuildReleaseDefinitionProvider")}getMenuItems(e,t){return this._items.removeAll(),t&&"ms.vss-build-web.run-actions"===e&&this._initializeBuild(t),this._items}async _initializeBuild(e){if(2!==e.result&&4!==e.result||2!==e.status)return;if(0===(await this._releaseDefinitionProvider.getReleaseDefinitionsByBuild(e.projectId,e.pipelineId)).length)return;const t=this.pageContext.getRestClient("IBuildRestClient"),n=await t.getBuild(e.projectId,e.runId);this._items.push({id:"run-release-action",text:u.Release,important:!1,onActivate:()=>{this.pageContext.getService("release-menu-service").createRelease(n)}})}}t[e].RunActionService=n,i.Services.add("release-run-action-service",{serviceFactory:n})}("RunActionService"),function(){t.ComponentsPipelineBillingMessageBanner={};class e extends s.VssComponent{constructor(e,t){super(e,t),this.concurrentJobsLink=(0,l.routeUrl)(this.context.pageContext,"ms.vss-build-web.build-release-collection-admin-route-new",{_a:"concurrentJobs"})}render(){return n.createElement("div",{className:"pipelinebilling-message-banner flex flex-grow fontSizeM info-message"},n.createElement(c.FormatComponent,{className:"concurrency-message",format:u.ConcurrencyMessageFormat},[n.createElement("a",{href:u.ConcurrencyDocumentLink,target:"_blank",rel:"noopener noreferrer",key:0},u.ConcurrencyDocumentLinkName),n.createElement("a",{href:this.concurrentJobsLink,target:"_blank",rel:"noopener noreferrer",key:1},u.CocurrentJobLimitsLinkName)]))}}e.componentType="pipelineBillingBanner",s.VssComponent.register(e.componentType,e)}()}),["Resources","ReleaseMenuService","RunActionService","Components/PipelineBillingMessageBanner"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-releaseManagement-web.sharedcontributions"}}));