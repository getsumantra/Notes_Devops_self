"use strict";define("VSSUI",["require","exports","VSS/Core/Util/String","react"],(function(e,t,i,a){var n,r,s,o,d,l,c,m,p,u,y,h,C,E,f,I,N,b;n=t[b="ResourcesPersona"]={},t[b].Loading="Loading...",t[b].IdentityCardLoadingText="Loading identities...",t[b].IdentityCardResultsFoundText="Showing {0} results",t[b].IdentityCardPlaceholderText="Search users and groups",t[b].IdentityCardNoResultsText="No identities found",t[b].IdentityCardContact="Contact",t[b].IdentityCardStartChat="Start chat",t[b].IdentityCardOrganization="Organization",t[b].IdentityCardReportingTo="Reporting to {0} ({1})",t[b].IdentityCardReportsTo="Reports to",t[b].IdentityCardUnknownUser="Unknown user",t[b].IdentityCardProfileCardAriaLabel="Contact card",t[b].IdentityCardHeaderButtonLabel="Go back",t[b].IdentityCardContactInfo="Contact information",t[b].IdentityCardEmail="Email",t[b].IdentityCardPhoneNumber="Phone number",t[b].IdentityCardLocation="Location",t[b].IdentityCardTitle="Title",t[b].IdentityCardDepartment="Department",t[b].IdentityCardAlias="Alias",t[b].IdentityCardMembers="{0} members",t[b].IdentityCardMembersCount="Members ({0})",t[b].IdentityCardDistributionList="Distribution list",function(e){var a,n;function s(e){return i.equals(e.originDirectory,"aad",!0)&&!!e.originId&&!e.localId}r=t[e]={},function(e){e.EntraIDUser="aad",e.EntraIDGroup="aadgp",e.EntraIDServicePrincipal="aadsp"}(a=t[e].SubjectType||(t[e].SubjectType={})),function(e){e.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START="<",e.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END=">",e.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START="<<",e.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END=">>",e.TFS_GROUP_PREFIX="id:",e.AAD_IDENTITY_USER_PREFIX="user:",e.AAD_IDENTITY_GROUP_PREFIX="group:",e.IDENTITY_UNIQUENAME_SEPARATOR="\\",e.DESCRIPTOR_PREFIX="desc:"}(n=t[e].IdentitySeparators||(t[e].IdentitySeparators={})),t[e].getUniquefiedIdentityName=function(e){if(!e)return"";const t=e.signInAddress||e.samAccountName||e.mail||e.originId;if(s(e)){const t=i.equals(e.entityType,"Group",!0),a=t?n.AAD_IDENTITY_GROUP_PREFIX:n.AAD_IDENTITY_USER_PREFIX;return!e.signInAddress&&!e.mail||t?i.format("{0} {1}{2}{3}{4}",e.displayName,n.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,a,e.originId,n.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):i.format("{0} {1}{2}{3}\\{4}{5}",e.displayName,n.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,a,e.originId,e.signInAddress||e.mail,n.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END)}return function(e){if(!e.displayName)return!1;const t=e.displayName.indexOf("\\");return i.equals(e.entityType,"Group",!0)&&i.startsWith(e.displayName,"[")&&-1!==t&&i.endsWith(e.displayName.substring(0,t),"]")}(e)?e.localId?i.format("{0} {1}{2}{3}{4}",e.displayName,n.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,n.TFS_GROUP_PREFIX,e.localId.toUpperCase(),n.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):e.displayName?e.displayName:"":t?-1!==t.indexOf("@")||!e.scopeName||(r=e).subjectDescriptor&&r.subjectDescriptor.startsWith(a.EntraIDServicePrincipal)?i.format("{0} {1}{2}{3}",e.displayName,n.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,t,n.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):i.format("{0} {1}{2}\\{3}{4}",e.displayName,n.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,e.scopeName,t,n.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):e.subjectDescriptor?i.format("{0} {1}{2}{3}{4}",e.displayName,n.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,n.DESCRIPTOR_PREFIX,e.subjectDescriptor,n.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):e.displayName||"";var r},t[e].isEntraIDIdentity=s}("UtilitiesPersonaHelper"),function(e){s=t[e]={};class i extends a.Component{constructor(e){super(e),this.targetElement=a.createRef(),this.showIdentityCard=()=>{this.props.personaProvider&&this.props.personaProvider.renderIdentityCard&&this.setState({showIdentityCard:!0})},this.onClick=e=>{this.props.personaProvider&&this.props.personaProvider.renderIdentityCard&&this.setState({showIdentityCard:!0}),e.preventDefault()},this.hideIdentityCard=()=>{this.setState({showIdentityCard:!1})},this.state={imageError:!1,imageLoaded:!1,showIdentityCard:!1}}render(){const{ariaLabel:e,ariaHidden:i,className:n,personaProvider:s,identity:o,role:d,size:l,tooltipProps:c}=this.props,m=!!s&&!!s.renderIdentityCard,p=o.image||o.imageUrl,u="entityId"in o?(0,r.getUniquefiedIdentityName)(o):"";return a.createElement(a.Fragment,null,a.createElement("div",{"aria-hidden":i,ref:this.targetElement},a.createElement(t.Coin.Coin,{ariaLabel:e,className:n,dataIsFocusable:m,isTabStop:m,onClick:m?this.onClick:void 0,displayName:o.displayName||"",principalName:u,imageUrl:this.getServerImageFromSize(p),role:d,size:l,tooltipProps:c})),this.state.showIdentityCard&&s&&s.renderIdentityCard&&s.renderIdentityCard(o,s,this.hideIdentityCard,this.targetElement.current))}getServerImageFromSize(e){if(e){if(this.props.size){if(this.props.size<=24)return e+(-1===e.indexOf("?")?"?size=0":"&size=0");if(this.props.size>40)return e+(-1===e.indexOf("?")?"?size=2":"&size=2")}return e}}}t[e].Persona=i}("ComponentsPersonaPersona"),function(e){o=t[e]={};t[e].CardContactLine=e=>a.createElement("div",{className:"bolt-identity-default-card-contact-line-wrapper flex-row"},a.createElement(t.Icon.Icon,{iconName:e.iconName,className:"bolt-identity-default-card-contact-line-label font-size"}),e.link&&a.createElement(t.Link.Link,{className:"flex-row word-wrap",href:e.link,removeUnderline:!0},e.hiddenLabel&&a.createElement("span",{className:"screen-reader-only"},e.hiddenLabel),e.content),!e.link&&a.createElement("span",{className:"bolt-identity-default-card-contact-line-no-link word-wrap"},e.content))}("ComponentsIdentityCardCardContactLine"),function(e){d=t[e]={};t[e].ContactCardContactLine=e=>{const{content:i,label:n,link:r,padTop:s}=e;return a.createElement("div",{className:"flex-column scroll-hidden"},a.createElement("div",{className:(0,t.Util.css)("bolt-identity-contact-card-line flex-row flex-grow",s&&"bolt-identity-contact-card-line-top")},a.createElement("div",{className:"bolt-identity-contact-card-span-label flex-noshrink"},n),a.createElement("div",{className:"bolt-identity-contact-card-span-content flex-grow flex-row"},r&&i&&a.createElement(t.Link.Link,{className:"flex-row text-ellipsis",href:r},i),!r&&i)))};t[e].ContactCard=i=>{const{identity:r}=i;return a.createElement("div",{className:"bolt-bolt-identity-contact-card-organization-card-wrapper flex-column scroll-hidden"},a.createElement("div",{className:"bolt-identity-contact-card-header-wrapper"},a.createElement("div",{className:"body-m"},n.IdentityCardContactInfo)),a.createElement("div",{className:"bolt-identity-contact-card-info-wrapper flex-column flex-grow body-s"},a.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardEmail,content:r.mail,link:`mailto:${r.mail}`}),a.createElement(t[e].ContactCardContactLine,{content:r.telephoneNumber,label:n.IdentityCardPhoneNumber,link:`mailto:${r.telephoneNumber}`}),a.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardLocation,content:r.physicalDeliveryOfficeName}),a.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardTitle,content:r.jobTitle,padTop:!0}),a.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardDepartment,content:r.department}),a.createElement(t[e].ContactCardContactLine,{label:n.IdentityCardAlias,content:r.mailNickname})))}}("ComponentsIdentityCardContactCard"),function(e){l=t[e]={};t[e].DefaultAbridgedCard=e=>{const{displayName:t,signInAddress:i}=e.identity;return a.createElement("div",{className:"bolt-default-card-abridged flex-column scroll-hidden"},a.createElement("div",{className:"flex-row"},a.createElement(s.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:e.identity}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name scroll-hidden"},a.createElement("div",{className:"word-wrap title-s"},t))),function(e){return!!e&&!!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(e)}(i)&&a.createElement("div",{className:"flex-column scroll-hidden"},a.createElement("div",{className:"bolt-identity-default-card-info-wrapper"},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement("b",null,n.IdentityCardContact))),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},a.createElement(o.CardContactLine,{iconName:"Mail",hiddenLabel:n.IdentityCardEmail,content:i,link:`mailto:${i}`}),a.createElement(o.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${i}`}))))}}("ComponentsIdentityCardDefaultAbridgedCard"),function(e){c=t[e]={};class i extends a.Component{constructor(){super(...arguments),this.contactButtonRef=a.createRef()}componentDidMount(){this.contactButtonRef.current&&this.contactButtonRef.current.focus()}render(){const{identity:e,isPreviousHeader:i}=this.props,{displayName:r,department:d,jobTitle:l,mail:c,physicalDeliveryOfficeName:m,telephoneNumber:p}=e;return a.createElement("div",{className:(0,t.Util.css)("bolt-identity-card-content flex-column scroll-hidden",i?"bolt-identity-default-card-with-header":"bolt-identity-default-card-without-header")},a.createElement("div",{className:"flex-row"},a.createElement(s.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:this.props.identity}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name scroll-hidden"},a.createElement("div",{className:"word-wrap title-s"},r),""===l?void 0:a.createElement("div",{className:"text-ellipsis"},l),""===d?void 0:a.createElement("div",{className:"text-ellipsis"},d))),a.createElement("div",{className:"flex-column scroll-hidden"},(c||p||m)&&a.createElement("div",{className:"bolt-identity-default-card-info-wrapper "},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement(t.Button.Button,{"aria-label":n.IdentityCardContact,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element",onClick:()=>{this.props.showContactCard()},ref:this.contactButtonRef,role:"button",subtle:!0,text:n.IdentityCardContact},a.createElement(t.Icon.Icon,{iconName:"ChevronRight"}))),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container flex-column scroll-hidden"},c&&a.createElement(o.CardContactLine,{iconName:"Mail",hiddenLabel:n.IdentityCardEmail,content:c,link:`mailto:${c}`}),c&&a.createElement(o.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${c}`}),p&&a.createElement(o.CardContactLine,{iconName:"Phone",hiddenLabel:n.IdentityCardPhoneNumber,content:p,link:`tel:${p}`}),m&&a.createElement(o.CardContactLine,{iconName:"POI",hiddenLabel:n.IdentityCardLocation,content:m}))),this.renderDirectManagerElement()))}renderDirectManagerElement(){if(!this.props.manager)return a.createElement("div",null);const e=this.props.manager,i={imageUrl:e.image,primaryText:e.displayName,secondaryText:e.jobTitle,tertiaryText:e.department};return a.createElement("div",{className:"bolt-identity-default-card-direct-manager-wrapper"},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement(t.Button.Button,{"aria-label":n.IdentityCardOrganization,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element",onClick:()=>{this.props.showOrganizationCard&&this.props.showOrganizationCard()},role:"button",text:n.IdentityCardOrganization,subtle:!0},a.createElement(t.Icon.Icon,{iconName:"ChevronRight"}))),a.createElement("div",{className:"bolt-identity-default-card-direct-manager"},a.createElement("div",{className:"bolt-identity-default-card-header-reportsto"},n.IdentityCardReportsTo),a.createElement("div",{className:"flex-row scroll-hidden bolt-identity-card-reports-to-wrapper"},a.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element bolt-profile-card-tab-element flex-shrink text-ellipsis","aria-label":e.displayName,key:e.entityId+e.signInAddress,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},a.createElement(s.Persona,{size:40,identity:e}),a.createElement("div",{className:"bolt-identity-card-text flex-column scroll-hidden"},a.createElement("div",{className:"primary-text flex-row text-ellipsis"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"secondary-text flex-row text-ellipsis"},i.secondaryText))))))}}t[e].DefaultCard=i}("ComponentsIdentityCardDefaultCard"),function(e){m=t[e]={};t[e].DefaultSimpleCard=e=>{const i={imageUrl:e.identity.image,primaryText:e.identity.displayName,secondaryText:e.identity.scopeName&&e.identity.signInAddress?e.identity.scopeName+"\\"+e.identity.signInAddress:e.identity.signInAddress?e.identity.signInAddress:""};return a.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(t=>a.createElement("div",{className:"bolt-identity-default-card-simple bolt-identity-card-content flex-row scroll-hidden"},a.createElement("div",{className:"flex-row flex-grow"},a.createElement(s.Persona,{className:"bolt-identity-card-persona-main",identity:e.identity,size:72}),a.createElement("div",{className:"bolt-identity-card-persona-text flex-column flex-grow"},a.createElement("div",{className:"primary-text flex-row title-s",tabIndex:0,"data-focuszone":t.focuszoneId},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"secondary-text flex-row body-l"},i.secondaryText))))))}}("ComponentsIdentityCardDefaultSimpleCard"),function(e){p=t[e]={};t[e].GroupMembersCard=e=>{const{members:r,onClickEntity:o}=e,d=(0,i.format)(n.IdentityCardMembers,r?r.length:0),l=r?r.map((e=>{const i={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return a.createElement("div",{className:"bolt-identity-card-persona-list-row flex-row flex-grow scroll-hidden",key:e.entityId+e.signInAddress},a.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row flex-grow flex-shrink text-ellipsis","aria-label":e.displayName,onClick:()=>{o&&o(e)},subtle:!0},a.createElement(s.Persona,{size:40,identity:e}),a.createElement("div",{className:"flex-column flex-grow flex-shrink bolt-identity-card-name scroll-hidden"},a.createElement("div",{className:"text-left text-ellipsis"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"text-left text-ellipsis"},i.secondaryText))))})):[];return a.createElement("div",{className:"bolt-identity-contact-card-organization-card-wrapper bolt-identity-card-content"},a.createElement("div",{className:(0,t.Util.css)("bolt-identity-organization-card-content v-scroll-auto h-scroll-hidden",0===l.length&&"flex-row justify-center")},l.length>0?a.createElement(a.Fragment,null,a.createElement("div",{className:"bolt-identity-organization-card-header-wrapper"},d," "),a.createElement("div",{className:"bolt-identity-organization-card-members-wrapper"},l)):a.createElement(t.Spinner.Spinner,{label:n.Loading,size:"large",className:"bolt-identity-card-loading-spinner"})))}}("ComponentsIdentityCardGroupMembersCard"),function(e){u=t[e]={};t[e].GroupCard=e=>{const{identity:r,members:d,showOrganizationCard:l}=e,{displayName:c,mail:m,physicalDeliveryOfficeName:p,telephoneNumber:u}=r,y=a.useRef(null),h=m||u||p;a.useEffect((()=>{h||y.current&&y.current.focus()}),[]);const C=(0,i.format)(n.IdentityCardMembersCount,d?d.length:0);return a.createElement("div",{className:"bolt-identity-default-card-without-header bolt-identity-card-content"},a.createElement("div",{ref:y,tabIndex:-1}),a.createElement("div",{className:"flex-row"},a.createElement(s.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:r}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name scroll-hidden"},a.createElement(t.TooltipEx.Tooltip,{text:c,overflowOnly:!0},a.createElement("div",{className:"word-wrap title-s"},c)),d&&d.length>0?a.createElement("div",{className:"word-wrap"},(0,i.format)(n.IdentityCardMembers,d.length)):void 0)),a.createElement("div",null,h&&a.createElement("div",{className:"bolt-identity-default-card-info-wrapper"},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},m&&a.createElement(o.CardContactLine,{iconName:"Mail",content:m,link:`mailto:${m}`}))),d&&d.length>0?a.createElement("div",{className:"bolt-identity-default-card-member-list-wrapper "},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement(t.Button.Button,{"aria-label":C,className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element flex-center",onClick:()=>{l&&l()},role:"button",text:C,subtle:!0},a.createElement(t.Icon.Icon,{iconName:"ChevronRight"})))):void 0))}}("ComponentsIdentityCardGroupCard"),function(e){y=t[e]={};t[e].GitHubCard=e=>{const{identity:t}=e,{displayName:i,mail:r,mailNickname:d}=t;return a.createElement("div",{className:"bolt-identity-default-card-without-header bolt-identity-card-content"},a.createElement("div",{className:"flex-row"},a.createElement(s.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:t}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name"},a.createElement("div",{className:"word-wrap title-s"},i),""===d?void 0:a.createElement("div",{className:"text-ellipsis"},d),""===r?void 0:a.createElement("div",{className:"text-ellipsis"},r))),a.createElement("div",null,(r||d)&&a.createElement("div",{className:"bolt-identity-default-card-info-wrapper"},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-header-wrapper"},a.createElement("div",{className:"bolt-identity-default-card-header pointer bolt-profile-card-tab-element"},n.IdentityCardContact)),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container"},d&&a.createElement(o.CardContactLine,{iconName:"GitHubLogo",content:"thomabr"}),r&&a.createElement(o.CardContactLine,{iconName:"Mail",content:r,link:`mailto:${r}`}),r&&a.createElement(o.CardContactLine,{iconName:"Chat",content:n.IdentityCardStartChat,link:`sip:${r}`})))))}}("ComponentsIdentityCardGitHubCard"),function(e){h=t[e]={};class r extends a.Component{constructor(){super(...arguments),this.createManagerChainIdentityElements=()=>{const e=this.props.managerList?this.props.managerList.map((e=>{const i={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return a.createElement("div",{className:"bolt-identity-card-persona-list-row flex-row flex-grow scroll-hidden",key:e.entityId+e.signInAddress},a.createElement(t.Button.Button,{"aria-label":e.displayName,className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row text-ellipsis",onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},a.createElement(s.Persona,{size:40,identity:e}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name text-ellipsis"},a.createElement("div",{className:"text-left text-ellipsis"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"text-left text-ellipsis"},i.secondaryText))))})):[],i={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department};return e.push(a.createElement("div",{className:"bolt-identity-card-persona-list-row flex-row flex-grow",key:this.props.identity.entityId+this.props.identity.signInAddress},a.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row flex-shrink text-ellipsis","aria-label":this.props.identity.displayName,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(this.props.identity)},subtle:!0},a.createElement(s.Persona,{size:40,identity:this.props.identity}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name text-ellipsis"},a.createElement("div",{className:"text-left text-ellipsis"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"text-left text-ellipsis"},i.secondaryText))))),e},this.createDirectReportsIdentityElements=()=>this.props.directReportList?this.props.directReportList.map((e=>{const i={imageUrl:e.image,primaryText:e.displayName?e.displayName:"",secondaryText:e.jobTitle?e.jobTitle:"",tertiaryText:e.department?e.department:""};return a.createElement("div",{className:"bolt-identity-card-persona-list-row flex-row flex-grow",key:e.entityId+e.signInAddress},a.createElement(t.Button.Button,{className:"bolt-identity-card-persona-list-element profile-card-tab-element flex-row text-ellipsis","aria-label":e.displayName,onClick:()=>{this.props.onClickEntity&&this.props.onClickEntity(e)},subtle:!0},a.createElement(s.Persona,{size:40,identity:e}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name text-ellipsis"},a.createElement("div",{className:"text-left text-ellipsis"},i.primaryText),""===i.secondaryText?void 0:a.createElement("div",{className:"text-left text-ellipsis"},i.secondaryText))))})):[]}render(){const e=this.createManagerChainIdentityElements(),t=this.createDirectReportsIdentityElements();return a.createElement("div",{className:"bolt-identity-contact-card-organization-card-wrapper bolt-identity-card-content"},a.createElement("div",{className:"bolt-identity-organization-card-content v-scroll-auto h-scroll-hidden"},a.createElement("div",{className:"bolt-identity-organization-card-header-wrapper"},n.IdentityCardOrganization," "),a.createElement("div",{className:"bolt-identity-organization-card-manager-chain-wrapper"},e),t.length>0&&a.createElement("div",{className:"bolt-identity-organization-card-direct-reports-wrapper"},(0,i.format)(n.IdentityCardReportingTo,this.props.identity.displayName,this.props.directReportList?this.props.directReportList.length:0),t)))}}t[e].OrganizationCard=r}("ComponentsIdentityCardOrganizationCard"),function(e){C=t[e]={};class i extends a.Component{constructor(){super(...arguments),this.contactButtonRef=a.createRef()}componentDidMount(){this.contactButtonRef.current&&this.contactButtonRef.current.focus()}render(){const{identity:e}=this.props,{displayName:i,mail:n,originId:r}=e;return a.createElement("div",{className:(0,t.Util.css)("bolt-identity-card-content flex-column scroll-hidden","bolt-identity-default-card-without-header")},a.createElement("div",{className:"flex-row"},a.createElement(s.Persona,{className:"bolt-identity-card-persona-main",size:72,identity:this.props.identity}),a.createElement("div",{className:"flex-column flex-grow bolt-identity-card-name scroll-hidden"},a.createElement("div",{className:"word-wrap title-s"},i),a.createElement("div",{className:"word-wrap"},n))),a.createElement("div",{className:"flex-column scroll-hidden"},a.createElement("div",{className:"bolt-identity-default-card-info-wrapper "},a.createElement("hr",{className:"bolt-identity-card-hr"}),a.createElement("div",{className:"bolt-identity-default-card-contact-info-container flex-column scroll-hidden"},r&&a.createElement(o.CardContactLine,{iconName:"ContactCard",content:r})))))}}t[e].ServicePrincipalCard=i}("ComponentsIdentityCardServicePrincipalCard"),function(e){E=t[e]={};class i extends a.Component{constructor(){super(...arguments),this.personaElement=a.createRef()}componentDidMount(){this.setFocus()}componentDidUpdate(){this.setFocus()}render(){const{identity:e}=this.props;return e?a.createElement("div",{className:"flex-row scroll-hidden"},a.createElement(t.Button.Button,{className:"bolt-identity-card-go-back-wrapper flex-row flex-grow scroll-hidden",onClick:this.props.onClickFunction,"aria-label":n.IdentityCardHeaderButtonLabel,ref:this.personaElement,primary:!0},a.createElement(t.Icon.Icon,{iconName:"ChevronLeftMed"}),a.createElement(s.Persona,{className:"bolt-identity-card-go-back",size:24,identity:e}),a.createElement("div",{className:"bolt-identity-card-name text-ellipsis"},e.displayName))):a.createElement("div",null)}setFocus(){this.personaElement.current&&this.personaElement.current.focus()}}t[e].IdentityCardHeaderElement=i}("ComponentsIdentityCardIdentityCardHeaderElement"),function(e){function i(e){return!!e&&!!e.originDirectory&&"aad"===e.originDirectory.trim().toLowerCase()}function a(e){return!!e&&!!e.originDirectory&&"ad"===e.originDirectory.trim().toLowerCase()}function n(e){return!!e&&!!e.entityType&&"group"===e.entityType.trim().toLowerCase()}function r(e){return!!e&&!!e.originDirectory&&"vsd"===e.originDirectory.trim().toLowerCase()}function s(e){return!!e&&!!e.originDirectory&&"wmd"===e.originDirectory.trim().toLowerCase()}f=t[e]={},t[e].isCompleteIdentity=function(e,t){return!!e&&(n(e)?e.mail||e.displayName:i(e)||a(e)?!!(t&&e.mail||e.mailNickname||e.jobTitle||e.department||e.physicalDeliveryOfficeName||e.manager||e.surname||e.telephoneNumber):r(e)?!!e.signInAddress:!!s(e)&&!(!e.scopeName&&!e.signInAddress))},t[e].isAadUser=i,t[e].isAadServicePrincipal=function(e){return!!e&&!!e.subjectDescriptor&&e.subjectDescriptor.trim().startsWith("aadsp")},t[e].isAdUser=a,t[e].isGithubUser=function(e){return!!e&&!!e.originDirectory&&"github"===e.originDirectory.trim().toLowerCase()},t[e].isGroup=n,t[e].isVsdUser=r,t[e].isWmdUser=s}("ComponentsIdentityCardIdentityCardIdentityUtils"),function(e){I=t[e]={};class i extends a.Component{constructor(){super(...arguments),this.calloutAnchorOrigin={horizontal:"start",vertical:"start"},this.determineAnchorOrigin=()=>{this.calloutAnchorOrigin=window.matchMedia("(max-width: 600px)").matches?{horizontal:"start",vertical:"start"}:{horizontal:"end",vertical:"start"}},this.onKeyDown=e=>{27===e.which&&(this.onDismissCallout(),e.preventDefault())},this.onDismissCallout=()=>{this.props.onDismissCallback&&this.props.onDismissCallback()}}componentDidMount(){window.addEventListener("resize",this.determineAnchorOrigin),this.determineAnchorOrigin()}componentWillUnmount(){window.removeEventListener("resize",this.determineAnchorOrigin)}render(){const e=this.props.referenceHTMLComponent?this.props.referenceHTMLComponent:this.props.target;return a.createElement(t.Callout.Callout,{onDismiss:this.onDismissCallout,anchorElement:e,anchorOrigin:this.calloutAnchorOrigin,calloutOrigin:{horizontal:"start",vertical:"start"},ariaLabel:n.IdentityCardProfileCardAriaLabel,className:"bolt-identity-card-callout depth-8",contentClassName:"v-scroll-auto",escDismiss:!0,lightDismiss:!0,ref:this.props.calloutRef},a.createElement("div",null,this.renderCard()))}renderCard(){const e="bolt-identity-card scroll-h-hidden";if(this.props.working&&!f.isCompleteIdentity(this.props.dataProps.identity))return a.createElement("div",{className:(0,t.Util.css)(e,"loading flex-row justify-center")},a.createElement(t.Spinner.Spinner,{label:n.Loading,size:"large",className:"bolt-identity-card-loading-spinner"}));const i=f.isAdUser(this.props.dataProps.identity)||f.isAadUser(this.props.dataProps.identity)||f.isGroup(this.props.dataProps.identity),r=this.props.dataProps.header||void 0,s=this.renderInnerCard();return s?a.createElement(t.FocusZone.FocusZone,{circularNavigation:!0,defaultActiveElement:".bolt-identity-card-focus-element",direction:2,focusOnMount:!0,handleTabKey:!0},a.createElement("div",{className:"bolt-identity-card-focus-element",tabIndex:-1}),a.createElement("div",{className:e,onKeyDown:this.onKeyDown},i&&r&&a.createElement(E.IdentityCardHeaderElement,{identity:r,onClickFunction:this.props.onHeaderClick}),s)):a.createElement("div",null)}renderInnerCard(){const{identity:e,successors:t,managerList:i,directReportList:r}=this.props.dataProps;if(!e||!0===this.props.showUnknownUser)return a.createElement("div",{className:"bolt-identity-card-content bolt-identity-card-unknown-user-content flex-column flex-center justify-center title-xs scroll-hidden"},n.IdentityCardUnknownUser);const s=f.isGroup(e),o=f.isVsdUser(e),E=f.isWmdUser(e),I=f.isAadUser(e),N=f.isAadServicePrincipal(e),b=f.isAdUser(e),g=f.isGithubUser(e);if(s)switch(this.props.dataProps.cardType){case 2:return a.createElement(p.GroupMembersCard,{identity:e,members:t,onClickEntity:this.props.onClickEntity});case 0:return a.createElement(u.GroupCard,{identity:e,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,members:t,showOrganizationCard:this.props.onShowOrganizationCard})}else{if(g)return a.createElement(y.GitHubCard,{identity:e});if(o)return a.createElement(l.DefaultAbridgedCard,{identity:e});if(E)return a.createElement(m.DefaultSimpleCard,{identity:e});if(N)return a.createElement(C.ServicePrincipalCard,{identity:e});if(I||b)switch(this.props.dataProps.cardType){case 1:return a.createElement(d.ContactCard,{identity:e});case 2:return a.createElement(h.OrganizationCard,{identity:e,managerList:i,directReportList:r,onClickEntity:this.props.onClickEntity});default:const t=i&&i.length>0?i[i.length-1]:void 0;return a.createElement(c.DefaultCard,{identity:e,manager:t,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,showContactCard:this.props.onShowContactCard,showOrganizationCard:this.props.onShowOrganizationCard,onClickEntity:this.props.onClickEntity})}}return a.createElement("div",null)}}t[e].IdentityCardContent=i}("ComponentsIdentityCardIdentityCardContent"),function(e){N=t[e]={};class i extends a.Component{constructor(e){super(e),this.calloutRef=a.createRef(),this.onDismissCallback=()=>{this.props.onDismissCallback&&this.props.onDismissCallback()},this.headerOnClickHandler=()=>{this.state.dataState.previousDataState?this.setState({dataState:this.state.dataState.previousDataState,working:!1}):this.props.initialHeader&&this.props.initialHeader.onClickFunction&&this.props.initialHeader.onClickFunction()},this.onShowContactCard=()=>{const e=Object.assign(Object.assign({},this.state.dataState),{previousDataState:this.state.dataState,cardType:1,header:this.state.dataState.identity});this.setState({dataState:e})},this.onShowOrganizationCard=()=>{if(this.state.working||this.dismissed)return;const e=this.state.dataState;if(e.isGroup){const e=this.state.dataState,t=Object.assign(Object.assign({},e),{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t}),(!e.successors||e.successors.length<=1)&&(this.setState({working:!0}),this.resolveIdentity(t,this.props.onRequestConnectionInformation(e.identity)))}else if(e.managerList&&e.managerList.length<=1){const e=this.state.dataState,t=Object.assign(Object.assign({},e),{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t,working:!0}),this.resolveIdentity(t,this.props.onRequestConnectionInformation(e.identity,!0))}else{const e=this.state.dataState,t=Object.assign(Object.assign({},e),{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t,working:!1})}},this.onClickEntity=e=>{if(this.state.working)return;const t=this.state.dataState,i={identity:e,cardType:0,header:t.identity,isGroup:f.isGroup(t.identity),directReportList:[],managerList:[],previousDataState:t,displayName:e.displayName,imageUrl:e.image,email:e.mail};this.setState({dataState:i,working:!0}),this.getIdentityByUniqueAttribute(e)},this.updateConnections=(e,t)=>{this.dismissed||this.state.dataState&&e.identity===this.state.dataState.identity&&this.setState({dataState:Object.assign(Object.assign({},this.state.dataState),{managerList:t.managers&&t.managers.reverse(),directReportList:t.directReports,successors:t.successors}),working:!1})},this.updateEntity=e=>{if(!e)return void this.setState({working:!1});if(!f.isCompleteIdentity(e,!0))return void this.setState({working:!1,showUnknownUser:!0});const t=f.isGroup(e)&&(!this.state.dataState.successors||this.state.dataState.successors.length<=0)||f.isAadUser(e)||f.isAdUser(e),i=this.props.imageUrl?this.props.imageUrl:e.image,a=Object.assign(Object.assign({},this.state.dataState),{identity:e,displayName:e.displayName,imageUrl:i,isGroup:f.isGroup(e)});t?(this.setState({dataState:a,working:!1}),this.resolveIdentity(a,this.props.onRequestConnectionInformation(a.identity))):this.setState({dataState:a,working:!1})};const t={identity:e.identity,managerList:void 0,directReportList:void 0,previousDataState:void 0,cardType:0,header:e.initialHeader?e.initialHeader.identity:void 0,displayName:e.displayName,imageUrl:e.imageUrl,email:this.getEmail(),isGroup:f.isGroup(e.identity)};let i=!0;e.identity||e.uniqueAttribute||!e.displayName||(t.identity={entityId:"",entityType:"user",originDirectory:"vsd",originId:"",displayName:e.displayName,image:e.imageUrl,signInAddress:t.email},i=!1),this.state={dataState:t,showUnknownUser:!1,working:i}}componentDidMount(){this.state.working&&this.setupInitialData(this.props.uniqueAttribute)}componentDidUpdate(){this.calloutRef.current&&!this.state.working&&this.calloutRef.current.updateLayout()}componentWillUnmount(){this.dismissed=!0}render(){return this.props.uniqueAttribute||this.props.identity||this.props.displayName?a.createElement(I.IdentityCardContent,Object.assign({},this.props,{dataProps:this.state.dataState,onClickEntity:this.onClickEntity,onDismissCallback:this.onDismissCallback,onShowContactCard:this.onShowContactCard,onShowOrganizationCard:this.onShowOrganizationCard,working:this.state.working,onHeaderClick:this.headerOnClickHandler,calloutRef:this.calloutRef,showUnknownUser:this.state.showUnknownUser})):null}setupInitialData(e){const t=this.state.dataState;!t.identity&&e?this.getIdentityByUniqueAttribute(e):t.identity&&!f.isCompleteIdentity(t.identity)?this.getIdentityByUniqueAttribute(t.identity):f.isGroup(t.identity)&&t.successors&&t.successors.length>0?this.resolveIdentity(t,{successors:t.successors}):this.resolveIdentity(t,this.props.onRequestConnectionInformation(t.identity))}resolveIdentity(e,t){const i=t,a=t;a&&a.then?a.then((t=>{this.updateConnections(e,t)})):i&&this.updateConnections(e,i)}resolveIEntity(e){const t=e,i=e;i&&i.then?i.then((e=>{this.updateEntity(e)})):this.updateEntity(t)}getIdentityByUniqueAttribute(e){let t;t="string"==typeof e?e:f.isGroup(e)||f.isAadUser(e)||f.isAdUser(e)?e.entityId:e.signInAddress?e.signInAddress:"",this.resolveIEntity(this.props.getEntityFromUniqueAttribute(t))}getEmail(){if(this.props.identity){if((f.isAadUser(this.props.identity)||f.isAdUser(this.props.identity))&&this.props.identity.mail)return this.props.identity.mail;if(this.props.identity&&this.props.identity.signInAddress)return this.props.identity.signInAddress;if(this.props.identity&&this.props.identity.mail)return this.props.identity.mail;if(this.props.uniqueAttribute){const e=this.props.uniqueAttribute.split("@");if(2===e.length&&e[0].length>=1&&e[1].length>=3){if(e[1].split(".").length>1)return this.props.uniqueAttribute}}}return""}}t[e].IdentityCard=i}("ComponentsIdentityCardIdentityCard"),function(e){t[e]={},Object.defineProperty(t[e],"Persona",{enumerable:!0,get:function(){return s.Persona}})}("Persona"),function(e){t[e]={},Object.defineProperty(t[e],"IdentityCard",{enumerable:!0,get:function(){return N.IdentityCard}})}("IdentityCard")}),["Resources.Persona","Utilities/PersonaHelper","Components/Persona/Persona","Components/IdentityCard/CardContactLine","Components/IdentityCard/ContactCard","Components/IdentityCard/DefaultAbridgedCard","Components/IdentityCard/DefaultCard","Components/IdentityCard/DefaultSimpleCard","Components/IdentityCard/GroupMembersCard","Components/IdentityCard/GroupCard","Components/IdentityCard/GitHubCard","Components/IdentityCard/OrganizationCard","Components/IdentityCard/ServicePrincipalCard","Components/IdentityCard/IdentityCardHeaderElement","Components/IdentityCard/IdentityCardIdentityUtils","Components/IdentityCard/IdentityCardContent","Components/IdentityCard/IdentityCard","Persona","IdentityCard"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-persona-content"}}));