"use strict";define("TFS/Msal",["require","exports","react","VSS/Platform/Layout","VSS/Platform/Context","VSSUI/Dialog"],(function(e,t,s,o,i,n){var r,a;r=t[a="Resources"]={},t[a].DialogTitle="Authenticate",t[a].OpenPopup="Open popup",t[a].ReauthenticationDialogText="Azure DevOps needs to update your authentication.",t[a].PopupBlockedMessage="It looks like popups are blocked. Please click the Open Popup button to open the authentication window.",t.TfsMsalInteractiveServicetypes={},function(){t.SignoutComponent={};const e=["ru","sessionId"];class i extends o.VssComponent{constructor(t,s){super(t,s);const o=new URLSearchParams(window.location.search),i=new URLSearchParams;e.forEach((e=>{const t=o.get(e);t&&i.set(e,t)}));const n=s.pageContext.getService("ITfsMsalInteractiveService");n&&n.signOut(i)}render(){return s.createElement("div",null)}}o.VssComponent.register("ms.vss-tfs-web.signout-component",i)}(),function(){t.TfsMsalLoginProviderService={};class e extends i.VssService{get loginRequired(){const e=this.pageContext.getService("ITfsPageService").getData();return!(null==e?void 0:e.project)||2!==e.project.visibility}}i.Services.add("IMsalLoginProviderService",{serviceFactory:e})}(),function(){t.TfsMsalInteractiveService={};class e extends i.VssService{signOut(e){const t=this.pageContext.getService("IVssContributionService").getData("ms.vss-tfs-web.tfs-signout-url-data-provider");return this.pageContext.getService("ITokenProviderService").logout().finally((()=>{if(null==t?void 0:t.signOutUrl){const s=new URL(t.signOutUrl,window.location.href);e&&e.forEach(((e,t)=>{s.searchParams.set(t,e)})),window.location.href=s.href}}))}}i.Services.add("ITfsMsalInteractiveService",{serviceFactory:e})}(),function(e){t[e]={};t[e].TfsMsalPopupDialog=e=>{const{openPopup:t}=e;return s.createElement(n.Dialog,{footerButtonProps:[{onClick:async()=>{try{const s=await t();e.onResolve(s)}catch(t){e.onReject(t)}finally{e.onDismiss()}},primary:!0,text:r.OpenPopup}],lightDismiss:!1,onDismiss:()=>{e.onReject("dialog dismissed"),e.onDismiss()},titleProps:{text:r.DialogTitle}},s.createElement("p",null,r.ReauthenticationDialogText),s.createElement("p",null,r.PopupBlockedMessage))}}("TfsMsalPopupDialog")}),["Resources","TfsMsalInteractiveService.types","SignoutComponent","TfsMsalLoginProviderService","TfsMsalInteractiveService","TfsMsalPopupDialog"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.msal"}}));