"use strict";define("InstantSearch/Shared",["require","exports","VSS/Core/Observable","VSS/Platform/Context","Wit/UI/Data","react","VSS/Platform/Layout","VSSUI/Icon","VSSUI/TooltipEx","Wit/UI/WorkItemTypeIcon","VSS/Core/Util/String","VSS/Platform/Feature","VSSUI/Utilities/FriendlyNumber","VSS/Features/PlatformUI/ContributedItemUtil","VSS/Core/TimerManagement","VSS/Features/PlatformUI/ContributedMenu","VSSUI/Menu"],(function(e,t,r,s,i,o,n,a,c,u,h,d,v,l,p,m,I){var g,S,_,P,k,y,f,b;g=t[b="Resources"]={},t[b].OthersHeader="Others",t[b].QuickNavigationPlaceholder="Type / for a list of filters",function(e){S=t[e]={},t[e].KeyDebounceTimeMs=200,t[e].AllHubs="All",t[e].InstantSearchProjectContextMenuContribution="ms.vss-work-web.instant-search-project-menu",t[e].InstantSearchCollectionContextMenuContribution="ms.vss-work-web.instant-search-collection-menu",t[e].InstantSearchDebouncedDelayInMs="Search/InstantSearch/DebouncedDelayInMs",t[e].KeyDebounceTimeMs2=500,t[e].InstantSearchDelayFeature="WebAccess.Search.WorkItem.InstantSearch.Delay",t[e].RemovePackageSearchFromInstantSearch="WebAccess.Search.WorkItem.InstantSearch.RemovePackageSearch",function(e){e.Area="Web",e.FeatureArea="SearchPortal",e.Feature="WorkItemSearchSuggestions"}(t[e].CustomerIntelligenceConstants||(t[e].CustomerIntelligenceConstants={}))}("Constants"),function(e){_=t[e]={};t[e].RequestManager=class{constructor(){this._requestId=0,this._lastResolvedRequestId=-1}get newRequestId(){return this._requestId++}isValidRequest(e){return e>this._lastResolvedRequestId&&(this._lastResolvedRequestId=e,!0)}}}("RequestManager"),function(e){P=t[e]={},t[e].getQueryTextWithWildCardChar=function(e){const t=e.trim();return t?t.endsWith('"')||t.endsWith("*")||t.endsWith("@me")||function(e){const t=e.lastIndexOf("@today");if(-1!=t){const r=e.substr(t);return new RegExp("^@today(\\s)*([+-])*(\\s)*[0-9]*$").test(r)}return!1}(t)?t:t+"*":""},t[e].getSetting=function(e,t,r){const s=e.getService("ISettingsService").getEntry(t,1);return null==s?r:s},t[e].isIE=function(){const e=window.navigator.userAgent.toLowerCase();return!!/msie ([\d+.]+)/i.exec(navigator.userAgent)||-1!==e.indexOf("trident")}}("Utils"),function(e){k=t[e]={};t[e].TelemetryWriter=class{constructor(e,t){this.pageContext=e,this.feature=t,this.publish=(e,t={})=>{this.pageContext.getService("IVssTelemetryService").publishEvent(S.CustomerIntelligenceConstants.Area,this.feature,Object.assign(Object.assign({},t),{event:e}))},this.notifySearchStarted=(e,t,r)=>{let s;const i={featureName:this.feature,eventName:e,isExcludedFromTTI:this._excludeMarkingTTI};return s=this._ttiMarked?this.service.startScenario(r,!this._excludeMarkingTTI,void 0,i):this.service.startScenario(t,!this._excludeMarkingTTI,void 0,i),s.featureArea=S.CustomerIntelligenceConstants.FeatureArea,s},this.notifySearchFailed=(e,t)=>{e.addProperties({isAborted:!0,error:t}),e.complete(),this._ttiMarked||(this._ttiMarked=!0)},this.notifyResultsRendered=e=>{e.complete(),this._ttiMarked||(this._ttiMarked=!0)},this._ttiMarked=!1,this._excludeMarkingTTI=(0,P.getSetting)(this.pageContext,"Search/Telemetry/ExcludeMarkingTTI",!1)}get service(){return this.pageContext.getService("IVssPerformanceService")}}}("TelemetryWriter"),function(e){y=t[e]={};class i extends s.VssService{constructor(){super(...arguments),this._requestManager=new _.RequestManager,this._menuItems=new r.ObservableArray,this.getSuggestions=(e,t,r,s,i)=>{const o=performance.now(),{telemetryWriter:n,invokedProvidersProps:a}=t,c=this._requestManager.newRequestId;let u,h=!1;s&&i&&(h=!0,u=n.notifySearchStarted(r,s,i),u.addProperties({isQuickNavigationMode:!!a})),this._fetchResults(e,t).then((s=>{const i=performance.now()-o;n.publish(r,{timeToFetch:i}),this._requestManager.isValidRequest(c)&&this._onFetchSuccess(e,t,s,u),h&&u&&n.notifyResultsRendered(u)}),(e=>{this._onFetchFail(t,e,u),h&&u&&n.notifySearchFailed(u,e)}))}}clearMenuItems(){this._menuItems.splice(0,this._menuItems.length),this._isHubSupportedByDefault=void 0}getMenuItems(e,t){const{searchInput:r}=t,s=this.shouldInvokeProvider(t),i=r.queryText().trim(),o=(0,P.getQueryTextWithWildCardChar)(i);return this._getMenuItems(e,t,s,o)}isHubSupportedByDefault(e){if(null==this._isHubSupportedByDefault){const t=this._contribution?this._contribution.defaultSupportedHubs||[S.AllHubs]:[];this._isHubSupportedByDefault=-1!==t.findIndex((t=>t===e||t===S.AllHubs))}return this._isHubSupportedByDefault}shouldInvokeProvider(e){const t=this._contribution?this._contribution.menuId:"",r=this._contribution?this._contribution.searchProviderId:"",{providerMenuIds:s,hubName:i,invokedProvidersProps:o,searchInput:n}=e,a=-1!==s.findIndex((e=>e===t)),c=!!o||this.isHubSupportedByDefault(i);return r&&o&&-1!==this._providerInvocationProps.findIndex((e=>e.key===o.key))&&n.setHelpSearchProviderId(r),a&&c}_initContribution(e){const t=this.pageContext.getService("IVssContributionService").getContribution(e);t&&(this._contribution=t,this._groupKey=t.groupKey,this._rank=t.rank,this._providerInvocationProps=t.providerInvocationProps||[])}_fetchResults(e,t){return Promise.resolve({})}_getMenuItems(e,t,r,s){return null}_onFetchSuccess(e,t,r,s){}_onFetchFail(e,t,r){}}t[e].BaseInstantSearchProvider=i}("InstantSearchProvidersBaseInstantSearchProvider"),function(){t.ServicesWorkItemTrackingDataProviderService={};class e extends s.VssService{_serviceStart(e){super._serviceStart(e),this._dataProvider=new i.WorkItemTrackingDataProvider(e)}getDataProvider(){return this._dataProvider}}s.Services.add("IWorkItemTrackingDataProviderService",{serviceFactory:e})}(),function(e){f=t[e]={};class r extends n.VssComponent{render(){const{title:e,mutedText:t,mutedTextAriaLabel:r,iconProps:s,workItemIconProps:n}=this.props;return o.createElement("div",{className:"search-suggestion-row flex-row flex-center"},o.createElement("span",{className:"search-suggestion-icon flex-row flex-noshrink"},s&&o.createElement(a.Icon,{iconName:s.iconName,className:s.iconClass}),n&&o.createElement(i.WorkItemTypeIconProvider,{dataProvider:this.workItemTrackingDataProvider,dataSource:{projectIdOrName:n.project,workItemTypeName:n.workItemType}},(e=>o.createElement(u.WorkItemTypeIcon,{data:e})))),o.createElement(c.Tooltip,{overflowOnly:!0,text:e},o.createElement("span",{className:"search-suggestion-title text-ellipsis"},e)),t&&o.createElement("span",{"aria-label":r,className:"muted-text"},t))}get workItemTrackingDataProvider(){if(!this._workItemTrackingDataProvider){const e=this.context.pageContext.getService("IWorkItemTrackingDataProviderService");this._workItemTrackingDataProvider=e.getDataProvider()}return this._workItemTrackingDataProvider}}t[e].ResultRow=r}("ResultRow"),function(){t.ServicesExecuteSearchService={};class e extends s.VssService{executeSearch(e,t,r,s,i){if(e){const o=this.pageContext.getService("IVssSearchService"),n=this.pageContext.getService("IVssContributionService"),a=t||o.getSelectedProvider();if(a){const t=r?{providerId:a,queryText:e,openInNewWindow:s,type:r}:{providerId:a,queryText:e,openInNewWindow:s};n.getService(a).then((e=>{const r=e&&e.getQuery?e.getQuery(t):t;this._executeSearchAndCallback(o,r,i)}),(e=>{this._executeSearchAndCallback(o,t,i)}))}}}_executeSearchAndCallback(e,t,r){r&&r(),e.execute(t)}}s.Services.add("IExecuteSearchService",{serviceFactory:e})}(),function(e){t[e]={};class r extends y.BaseInstantSearchProvider{constructor(){super(...arguments),this._contributionId="",this._otherEntities=[],this._addHeader=!1,this._executeSearch=(e,t,r,s,i)=>{this.pageContext.getService("IExecuteSearchService").executeSearch(e,t,r,s,i)},this._renderMenuCell=(e,t,r,s,i,n)=>{if(r.onFocusItem=n,2===e)return o.createElement(f.ResultRow,{iconProps:s,title:i})},this._onOtherResultClick=(e,t,r)=>{t(!0),r.publish("ResultClicked",{index:e.index,resultType:"OtherResults",entityType:e.entity})}}get telemetryWriter(){return this._telemetryWriter||(this._telemetryWriter=new k.TelemetryWriter(this.pageContext,S.CustomerIntelligenceConstants.Feature)),this._telemetryWriter}_serviceStart(e){super._serviceStart(e),this._initContribution(this._contributionId),this._legacySearchClient=e.getRestClient("Legacy.ISearchRestClient")}_getMenuItems(e,t,r,s){return r&&s?(0===this._menuItems.length&&this._updateOtherSuggestions(t,!0),this.getSuggestions(s,t,"OtherSuggestionsFetched")):this._menuItems.splice(0,this._menuItems.length),this._menuItems}_initContribution(e){super._initContribution(e);const t=this.pageContext.getService("IVssSearchService").getSelectedProvider();this._contribution&&this._contribution.menuProps&&this._contribution.menuProps.forEach((e=>{var s;if(e.searchProviderId!==t){if((0,d.isFeatureFlagEnabled)(this.pageContext,S.RemovePackageSearchFromInstantSearch,!1)&&e.searchProviderId.includes("package"))return void(null===(s=this.telemetryWriter)||void 0===s||s.publish("PackageSearchRemoved",{selectedProviderId:t}));this._otherEntities.push(Object.assign({},e)),r._setHeader&&(r._setHeader=!1,this._addHeader=!0)}}))}_fetchResults(e,t){const r=this._otherEntities.map((t=>{const r={searchFilters:this.projectProperties?{[t.searchProjectFilter]:[this.projectProperties.name]}:{},searchText:e},s=t.entity;return this._legacySearchClient.resultsCount(r,s,this.projectProperties&&this.projectProperties.id)}));return Promise.all(r)}_onFetchSuccess(e,t,r){const{searchInput:s}=t;this.shouldInvokeProvider(t)&&!s.queryText().trim()?this._menuItems.splice(0,this._menuItems.length):(this._otherEntities.forEach(((e,t)=>{const s=r[t],i=2===s.relationFromExactCount;e.count=s.count,e.showPlus=i})),this._updateOtherSuggestions(t))}_onFetchFail(e,t){}_updateOtherSuggestions(e,t){this._menuItems.splice(0,this._menuItems.length),this._addHeader&&this._menuItems.push({id:"",groupKey:this._groupKey,rank:this._rank,itemType:2,text:g.OthersHeader,className:"search-suggestion-header"}),this._otherEntities.forEach(((r,s)=>{const{count:i,entity:o}=r,n=void 0===i||t?r.label:(0,h.format)("{0} ({1})",r.label,(0,h.format)(r.showPlus?"{0}+":"{0}",(0,v.getFriendlyDisplayValue)(i))),{searchInput:a,telemetryWriter:c,onFocus:u}=e,d=a.queryText(),l={index:s,entity:o},p={iconClass:r.iconClass,iconName:r.iconName};this._menuItems.push({id:"",groupKey:this._groupKey,rank:this._rank+r.position,renderMenuCell:(e,t,r)=>this._renderMenuCell(e,t,r,p,n,u),onActivate:(e,t)=>this._executeSearch(d,r.searchProviderId,r.entity,t.ctrlKey,(()=>this._onOtherResultClick(l,a.setHelpVisibility,c)))})}))}get projectProperties(){if(!this._projectProperties){const e=this.pageContext.getService("ITfsPageService").getData();this._projectProperties=e?e.project:void 0}return this._projectProperties}}function i(e){return class extends r{constructor(){super(...arguments),this._contributionId=e}}}t[e].OtherResultsProvider=r,r._setHeader=!0,s.Services.add("code-other-results-project-provider-service",{serviceFactory:i("ms.vss-code-web.code-other-results-project-menu-provider")}),s.Services.add("workitem-other-results-project-provider-service",{serviceFactory:i("ms.vss-work-web.workitem-other-results-project-menu-provider")}),s.Services.add("wiki-other-results-project-provider-service",{serviceFactory:i("ms.vss-wiki-web.wiki-other-results-project-menu-provider")}),s.Services.add("package-other-results-project-provider-service",{serviceFactory:i("ms.feed.package-other-results-project-menu-provider")}),s.Services.add("commit-other-results-project-provider-service",{serviceFactory:i("ms.vss-code-web.commit-other-results-project-menu-provider")}),s.Services.add("code-other-results-collection-provider-service",{serviceFactory:i("ms.vss-code-web.code-other-results-collection-menu-provider")}),s.Services.add("workitem-other-results-collection-provider-service",{serviceFactory:i("ms.vss-work-web.workitem-other-results-collection-menu-provider")}),s.Services.add("wiki-other-results-collection-provider-service",{serviceFactory:i("ms.vss-wiki-web.wiki-other-results-collection-menu-provider")}),s.Services.add("package-other-results-collection-provider-service",{serviceFactory:i("ms.feed.package-other-results-collection-menu-provider")}),s.Services.add("commit-other-results-collection-provider-service",{serviceFactory:i("ms.vss-code-web.commit-other-results-collection-menu-provider")})}("InstantSearchProvidersOtherResultsProvider"),function(e){t[e]={};class r extends s.VssService{constructor(){super(...arguments),this._invocationKeyProviderMenuIdsMap={},this._invocationKeyPropsMap={},this._providerInvocationHelpProps=[]}get isProjectContext(){if(null==this._isProjectContext){const e=this.pageContext.getService("ITfsPageService").getData();this._isProjectContext=!(!e||!e.project)}return this._isProjectContext}get menuContributionId(){return this._menuContributionId||(this.isProjectContext?this._menuContributionId=S.InstantSearchProjectContextMenuContribution:this._menuContributionId=S.InstantSearchCollectionContextMenuContribution),this._menuContributionId}get providerInvocationHelpProps(){return this._providerInvocationHelpProps}_serviceStart(e){super._serviceStart(e),this.fetchInstantSearchMenuContribution().then((()=>{this._initialize()}))}fetchInstantSearchMenuContribution(){return this.pageContext.getService("IVssContributionService").getContributionAsync(this.menuContributionId)}getProvidersToInvoke(e){const t=(0,d.isFeatureFlagEnabled)(this.pageContext,"WebAccess.Search.WorkItem.QuickNavigation",!1)?this._invocationKeyProviderMenuIdsMap[e]:void 0,r=this._invocationKeyProviderMenuIdsMap.default,s=t||r,i=t?e:"",o=i?this._invocationKeyPropsMap[i]:void 0;return{providerMenuIds:s,invokedProvidersProps:i?{key:i,props:o}:void 0}}_initialize(){const e=(0,l.getContributedItems)(this.pageContext,this.menuContributionId,"menuId","ms.vss-web.menu-provider");for(const t of e){const{contribution:e}=t,{providerInvocationProps:r,menuId:s}=e;if(this._pushToInvocationKeyProvidersMap("default",s),r&&r.length>0)for(const e of r){const{key:t,quickNavigationHelpProps:r}=e;r&&!this._invocationKeyPropsMap[t]&&this._providerInvocationHelpProps.push(e),this._invocationKeyPropsMap[t]=e,this._pushToInvocationKeyProvidersMap(t,s)}}}_pushToInvocationKeyProvidersMap(e,t){this._invocationKeyProviderMenuIdsMap[e]?this._invocationKeyProviderMenuIdsMap[e].push(t):this._invocationKeyProviderMenuIdsMap[e]=[t]}}t[e].InstantSearchMetadataService=r,s.Services.add("IInstantSearchMetadataService",{serviceFactory:r})}("ServicesInstantSearchMetadataService"),function(e){t[e]={};class r extends s.VssService{getProvidersToInvoke(e,t){if(!this._invokedProvidersInfo||!this._invokedProvidersInfo.invokedProvidersProps||"/"===this._invokedProvidersInfo.invokedProvidersProps.key){const r=e.queryText().trim(),s=r.toLowerCase().split(" "),i=s[0],o=s.length>1?(0,h.format)("{0} {1}",s[0],s[1]):"",n="/",a=this.pageContext.getService("IInstantSearchMetadataService");this._invokedProvidersInfo=a.getProvidersToInvoke(i),!this._invokedProvidersInfo.invokedProvidersProps&&o&&(this._invokedProvidersInfo=a.getProvidersToInvoke(o)),!this._invokedProvidersInfo.invokedProvidersProps&&i.startsWith(n)&&(this._invokedProvidersInfo=a.getProvidersToInvoke(n)),this._setSearchPrefix(r,e,t)}return this._invokedProvidersInfo}setInvokedProvider(e,t,r){const s=this.pageContext.getService("IInstantSearchMetadataService");this._invokedProvidersInfo=s.getProvidersToInvoke(e),this._setSearchPrefix(e,t,r)}isQuickNavigationModeOn(){return!(!this._invokedProvidersInfo||!this._invokedProvidersInfo.invokedProvidersProps)}shouldAllowImmersiveSearch(){if(this._invokedProvidersInfo&&this._invokedProvidersInfo.invokedProvidersProps){const{props:e}=this._invokedProvidersInfo.invokedProvidersProps;return!!e&&!!e.allowImmersiveSearch}return!0}_setSearchPrefix(e,t,r){const{replaceText:s,setSearchPrefixProps:i,setPlaceholder:o}=t,{invokedProvidersProps:n}=this._invokedProvidersInfo;if(n&&n.props&&"/"!==n.key&&i&&o){const{key:a,props:c}=n;s(e.substr(a.length).trim()),i({prefixText:a,iconName:c.iconName}),o(c.placeholder),t.onSearchPrefixRemove=()=>{this._removeInvokedProvider(t)},r.publish("QuickNavigationActivated",{type:a})}}_removeInvokedProvider(e){if(this._invokedProvidersInfo){this._invokedProvidersInfo.invokedProvidersProps=void 0;const{setPlaceholder:t,replaceText:r}=e;r(""),t&&t(g.QuickNavigationPlaceholder)}}}t[e].InvokedProvidersManager=r,s.Services.add("IInvokedProvidersManager",{serviceFactory:r})}("ServicesInvokedProvidersManager"),function(e){t[e]={};class r extends y.BaseInstantSearchProvider{constructor(){super(...arguments),this._contributionId="ms.vss-work-web.quick-navigation-help-menu-provider",this._recordQuickNavigationHelpClickTelemetry=(e,t)=>{t.publish("ResultClicked",{index:e,resultType:"QuickNavigationHelp"})}}_serviceStart(e){super._serviceStart(e),this._initContribution(this._contributionId)}_getMenuItems(e,t,r,s){const{searchInput:i,invokedProvidersProps:o}=t,n=i.queryText().trim().toLowerCase(),a=!(!o||!o.key||"/"===o.key);return n.startsWith("/")&&!a?this._loadQuickNavigationHelpMenuItems(t,n):this._menuItems.length>0&&this._menuItems.splice(0,this._menuItems.length),this._menuItems}_loadQuickNavigationHelpMenuItems(e,t){const r=this.pageContext.getService("IInstantSearchMetadataService").providerInvocationHelpProps.filter((e=>e.key.startsWith(t))),{invokedProvidersProps:s}=e,i=s&&s.props?s.props.header:"";this._menuItems.splice(0,this._menuItems.length),r.length>0&&(this._menuItems.push({id:"",groupKey:this._groupKey,rank:this._rank,itemType:2,text:i,className:"search-suggestion-header"}),r.forEach(((t,r)=>{const{searchInput:s,telemetryWriter:i}=e,{iconName:n}=t,{title:a,position:c}=t.quickNavigationHelpProps;this._menuItems.push({id:"",groupKey:this._groupKey,rank:this._rank+c,renderMenuCell:(e,t,r)=>{if(2===e)return o.createElement(f.ResultRow,{iconProps:{iconName:n||"ArrowUpRight8"},title:a})},onActivate:(e,o)=>{this.pageContext.getService("IInvokedProvidersManager").setInvokedProvider(t.key,s,i),this._recordQuickNavigationHelpClickTelemetry(r,i)}})})))}}t[e].QuickNavigationHelpProvider=r,s.Services.add("quick-navigation-help-provider-service",{serviceFactory:r})}("InstantSearchProvidersQuickNavigationHelpProvider"),function(e){t[e]={};class s extends n.VssComponent{constructor(e,t){super(e,t),this._removeManualFocus=!0,this._isMounted=!1,this._isFirstCall=!0,this._menuItems=new r.ObservableArray,this.invokeActionOfSelectedItem=()=>{const e=this.state.menuItems.value.filter((e=>e.className&&e.className.includes("focused"))),t=e&&1===e.length?e[0]:void 0;if(t&&t.onActivate)t.onActivate(t);else{const{searchInput:e}=this.props,t=(0,P.getQueryTextWithWildCardChar)(e.queryText());this.context.pageContext.getService("IExecuteSearchService").executeSearch(t,void 0,void 0,!1,(()=>{this._telemetryWriter.publish("ImmersiveSearchPerformed")}))}},this._debouncedOnResultsUpdate=()=>{const{searchInput:e}=this.props,t=e.queryText(),r=!t,s=!!t&&t.length>1;this._isFirstCall=this._isFirstCall&&s||r,this._isFirstCall?this._updateMenuItems():this._debouncedUpdate()},this._updateMenuItems=()=>{const{searchInput:e}=this.props,t=(0,d.isFeatureFlagEnabled)(this.context.pageContext,"WebAccess.Search.WorkItem.QuickNavigation",!1),r=this.context.pageContext.getService("IInvokedProvidersManager"),s=r.getProvidersToInvoke(e,this._telemetryWriter),{providerMenuIds:i,invokedProvidersProps:o}=s,n=r.isQuickNavigationModeOn(),{queryText:a,setPlaceholder:c}=e;t&&!a().trim()&&!n&&c&&c(g.QuickNavigationPlaceholder),this._menuItems=(0,m.getMenuItems)(this.context.pageContext,this._contributionId,{searchInput:this.props.searchInput,hubName:this.props.hubName,telemetryWriter:this._telemetryWriter,onFocus:this._clearManualFocus,providerMenuIds:i,invokedProvidersProps:o}),this._removeManualFocus=!0,this._refreshMenuItems()},this._refreshMenuItems=(e,t)=>{this._isMounted&&this.setState({menuItems:this._menuItems})},this._clearManualFocus=(e,t)=>{if(this._removeManualFocus){this._removeManualFocus=!1;let e=!1;this._menuItems.value.forEach((t=>{t.className&&"focused"===t.className&&(t.className="",e=!0)})),e&&(0,P.isIE)()&&this.forceUpdate()}},this.state={menuItems:new r.ObservableArray};const{featureName:s}=e;this._telemetryWriter=new k.TelemetryWriter(this.context.pageContext,s);let i=(0,P.getSetting)(t.pageContext,S.InstantSearchDebouncedDelayInMs,S.KeyDebounceTimeMs);(0,d.isFeatureFlagEnabled)(this.context.pageContext,S.InstantSearchDelayFeature,!1)&&(i=S.KeyDebounceTimeMs2),this._debouncedUpdate=(new p.TimerManagement).debounce(this._updateMenuItems,i)}render(){const{menuItems:e}=this.state;return o.createElement(I.Menu,{className:"instant-search-suggestions",id:"instant-search-menu",items:e})}componentDidMount(){const e=this.context.pageContext.getService("IInstantSearchMetadataService");this._contributionId=e.menuContributionId,e.fetchInstantSearchMenuContribution().then((()=>{this._isMounted=!0;const e=this.props.featureName+"Invoked";this._telemetryWriter.publish(e),this.props.searchInput.subscribe(this._debouncedOnResultsUpdate),this._updateMenuItems(),this._menuItems.subscribe(this._refreshMenuItems),this.props.searchInput.setHelpVisibility(!1)}))}componentWillUnmount(){this._isMounted=!1,this.props.searchInput.unsubscribe(this._debouncedOnResultsUpdate),this._menuItems.unsubscribe(this._refreshMenuItems),this._clearMenuItems()}_clearMenuItems(){const e=this.context.pageContext.getService("IVssContributionService"),t=(0,l.getContributedItems)(this.context.pageContext,this._contributionId,"menuId","ms.vss-web.menu-provider");for(const r of t){const t=e.getServiceSync(r.id,!0);t&&t.clearMenuItems&&t.clearMenuItems()}}}t[e].InstantSearchSuggestionsComponent=s}("SearchSuggestions")}),["Resources","Constants","RequestManager","Utils","TelemetryWriter","InstantSearchProviders/BaseInstantSearchProvider","Services/WorkItemTrackingDataProviderService","ResultRow","Services/ExecuteSearchService","InstantSearchProviders/OtherResultsProvider","Services/InstantSearchMetadataService","Services/InvokedProvidersManager","InstantSearchProviders/QuickNavigationHelpProvider","SearchSuggestions"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-work-web.instant-search-shared-content"}}));