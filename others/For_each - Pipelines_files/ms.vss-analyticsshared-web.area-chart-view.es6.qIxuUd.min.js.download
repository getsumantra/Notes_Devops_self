"use strict";define("Analytics/Shared/Visuals/AreaChartView",["require","exports","Analytics/Shared/Common/Constants","Analytics/Shared/Common/Utils/DateAdjuster","VSS/Features/Charts/Contracts","Analytics/Shared/Common/Utils/ChartDataConverter","Analytics/Shared/Analytics-Visuals-Common/LoadingComponent/LoadingComponent","react","VSS/Features/Charts/Chart","VSS/Platform/Layout"],(function(e,t,a,r,s,i,o,n,l,d){var p,c;p=t[c="Resources"]={},t[c].AreaChartTitle="Area Chart",t.CommonTypes={},function(e){t[e]={};t[e].AreaChartHelper=class{getAreaChartOptions(e,t,o,n,l){let d=[];const c=[];if(l){let e=t.map((e=>({date:e.date,data:i.toTwoDecimalPoint(e.aggrValue)})));e=(0,r.adjustDataForAllPeriod)(e,l.trendBy,l.period,void 0),t=e.map((e=>({date:e.date,aggrValue:e.data})))}return c.push({data:t.map((e=>void 0!==e.aggrValue?e.aggrValue:null)),color:o.color}),0==d.length&&t&&(d=t.map((e=>e.date))),this.chartProps={pageContext:e.pageContext,title:p.AreaChartTitle,chartType:s.ChartTypesConstants.Area,xAxis:{labelFormatMode:s.LabelFormatModes.DateTime_DayInMonth,labelsEnabled:!0,labelValues:d,formatAccessibleLabelsUsingAxisCategories:!0},yAxis:{labelsEnabled:!0,markingsEnabled:!1,title:o.name.toUpperCase(),max:o.maxValue,gridLineOptions:{enabled:!0,gridLineColor:a.gridLineColor}},suppressAnimation:!0,series:c,specializedOptions:{gradientFill:this.getGradientFill(o.color,.1,.1),includeMarkers:!0,lineWidth:2,disableStacking:!0}},n&&this.enableCompactMode(),this.chartProps}setSecondaryAxisLabelFormatMode(e,t,a,r){const s=this.getMaxSecondaryYAxisLabel(t,a);return e.yAxis?(e.yAxis.labelFormatMode=t,e.yAxis.max=s):e.yAxis={labelFormatMode:t,max:s},r&&(e.yAxis.title=r),e}setGradientFill(e,t){const a=this.getGradientFill(t,.05,0);return e.specializedOptions?e.specializedOptions.gradientFill=a:e.specializedOptions={gradientFill:a},e}setHostOptions(e,t){return e.hostOptions=t,e}setCustomTooltipMapping(e,t){return e.tooltip={customTooltipMapping:t},e}setAreaChartTitle(e,t){return e.title=t,e}getMaxSecondaryYAxisLabel(e,t){if(e!==s.LabelFormatModes.Percentage||!t)return;const a=t.values.filter((e=>null!=e));return Math.max(...a)>=80?t.maxValue:void 0}enableCompactMode(){this.chartProps.xAxis={labelsEnabled:!1,enabled:!1},this.chartProps.yAxis={labelsEnabled:!1,enabled:!1},this.chartProps.legend={enabled:!1},this.chartProps.tooltip={enabled:!1},this.chartProps.suppressMargin=!0,this.chartProps.specializedOptions.includeMarkers=!1,this.chartProps.hostOptions||(this.chartProps.hostOptions={height:150}),this.chartProps.accessibility={enabled:!1}}getGradientFill(e,t,a){return{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[{position:0,color:e,opacity:t},{position:1,color:e,opacity:a}]}}}}("CommonAreaChartHelper"),function(e){t[e]={};class a extends d.VssComponent{constructor(){super(...arguments),this.onWindowResize=()=>this.forceUpdate()}componentDidMount(){window.addEventListener("resize",this.onWindowResize)}render(){return this.props.errorText?this._renderError():this.props.chartOptions?n.createElement("div",{className:this.props.className},n.createElement(l.Chart,Object.assign({},this.props.chartOptions,{className:"flex-column"}))):n.createElement(o.LoadingComponent,{className:"card-spinner flex-column flex-grow",size:"large"})}_renderError(){return this.props.errorTextRenderer?this.props.errorTextRenderer(this.props.errorText):n.createElement("div",null,this.props.errorText)}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize)}}t[e].AreaChartView=a}("ControllerViewsAreaChartView")}),["Resources","Common/Types","Common/AreaChartHelper","ControllerViews/AreaChartView"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-analyticsshared-web.area-chart-view"}}));